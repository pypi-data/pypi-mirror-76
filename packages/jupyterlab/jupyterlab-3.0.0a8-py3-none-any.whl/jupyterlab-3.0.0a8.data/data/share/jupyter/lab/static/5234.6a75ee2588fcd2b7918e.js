(window["webpackJsonp_jupyterlab_application_top"]=window["webpackJsonp_jupyterlab_application_top"]||[]).push([[5234],{KYt7:(e,t,s)=>{"use strict";s.r(t);s.d(t,{FileBrowser:()=>me,BreadCrumbs:()=>g,IFileBrowserFactory:()=>pe,DirListing:()=>Z,CHUNK_SIZE:()=>ve,FileBrowserModel:()=>ye,FilterFileBrowserModel:()=>we,LARGE_FILE_SIZE:()=>ge,FileDialog:()=>be,FilenameSearcher:()=>oe,Uploader:()=>ee,FileUploadStatus:()=>ke});var i=s("V3w5");var n=s("at8A");var r=s("Sxpi");var o=s("aV2H");var a=s("3gBK");var l=s("490o");var d=s("0c61");var c=s("7mC3");const h="jp-BreadCrumbs";const m="jp-BreadCrumbs-home";const u="jp-BreadCrumbs-item";const p=["/","../../","../",""];const f="application/x-jupyter-icontents";const _="jp-mod-dropTarget";class g extends o.Widget{constructor(e){super();this._model=e.model;this.addClass(h);this._crumbs=v.createCrumbs();this._crumbSeps=v.createCrumbSeparators();this.node.appendChild(this._crumbs[v.Crumb.Home]);this._model.refreshed.connect(this.update,this)}handleEvent(e){switch(e.type){case"click":this._evtClick(e);break;case"lm-dragenter":this._evtDragEnter(e);break;case"lm-dragleave":this._evtDragLeave(e);break;case"lm-dragover":this._evtDragOver(e);break;case"lm-drop":this._evtDrop(e);break;default:return}}onAfterAttach(e){super.onAfterAttach(e);this.update();const t=this.node;t.addEventListener("click",this);t.addEventListener("lm-dragenter",this);t.addEventListener("lm-dragleave",this);t.addEventListener("lm-dragover",this);t.addEventListener("lm-drop",this)}onBeforeDetach(e){super.onBeforeDetach(e);const t=this.node;t.removeEventListener("click",this);t.removeEventListener("lm-dragenter",this);t.removeEventListener("lm-dragleave",this);t.removeEventListener("lm-dragover",this);t.removeEventListener("lm-drop",this)}onUpdateRequest(e){const t=this._model.manager.services.contents;const s=t.localPath(this._model.path);v.updateCrumbs(this._crumbs,this._crumbSeps,s)}_evtClick(e){if(e.button!==0){return}let t=e.target;while(t&&t!==this.node){if(t.classList.contains(u)||t.classList.contains(m)){const s=a.ArrayExt.findFirstIndex(this._crumbs,e=>e===t);this._model.cd(p[s]).catch(e=>(0,i.showErrorMessage)("Open Error",e));e.preventDefault();e.stopPropagation();return}t=t.parentElement}}_evtDragEnter(e){if(e.mimeData.hasData(f)){const t=a.ArrayExt.findFirstIndex(this._crumbs,t=>l.ElementExt.hitTest(t,e.clientX,e.clientY));if(t!==-1){if(t!==v.Crumb.Current){this._crumbs[t].classList.add(_);e.preventDefault();e.stopPropagation()}}}}_evtDragLeave(e){e.preventDefault();e.stopPropagation();const t=i.DOMUtils.findElement(this.node,_);if(t){t.classList.remove(_)}}_evtDragOver(e){e.preventDefault();e.stopPropagation();e.dropAction=e.proposedAction;const t=i.DOMUtils.findElement(this.node,_);if(t){t.classList.remove(_)}const s=a.ArrayExt.findFirstIndex(this._crumbs,t=>l.ElementExt.hitTest(t,e.clientX,e.clientY));if(s!==-1){this._crumbs[s].classList.add(_)}}_evtDrop(e){e.preventDefault();e.stopPropagation();if(e.proposedAction==="none"){e.dropAction="none";return}if(!e.mimeData.hasData(f)){return}e.dropAction=e.proposedAction;let t=e.target;while(t&&t.parentElement){if(t.classList.contains(_)){t.classList.remove(_);break}t=t.parentElement}const s=a.ArrayExt.findFirstIndex(this._crumbs,e=>e===t);if(s===-1){return}const n=this._model;const r=d.PathExt.resolve(n.path,p[s]);const o=n.manager;const l=[];const h=e.mimeData.getData(f);for(const i of h){const e=o.services.contents.localPath(i);const t=d.PathExt.basename(e);const s=d.PathExt.join(r,t);l.push((0,c.renameFile)(o,i,s))}void Promise.all(l).catch(e=>(0,i.showErrorMessage)("Move Error",e))}}var v;(function(e){let t;(function(e){e[e["Home"]=0]="Home";e[e["Ellipsis"]=1]="Ellipsis";e[e["Parent"]=2]="Parent";e[e["Current"]=3]="Current"})(t=e.Crumb||(e.Crumb={}));function s(e,s,i){const n=e[0].parentNode;const r=n.firstChild;while(r&&r.nextSibling){n.removeChild(r.nextSibling)}n.appendChild(s[0]);const o=i.split("/");if(o.length>2){n.appendChild(e[t.Ellipsis]);const i=o.slice(0,o.length-2).join("/");e[t.Ellipsis].title=i;n.appendChild(s[1])}if(i){if(o.length>=2){e[t.Parent].textContent=o[o.length-2];n.appendChild(e[t.Parent]);const i=o.slice(0,o.length-1).join("/");e[t.Parent].title=i;n.appendChild(s[2])}e[t.Current].textContent=o[o.length-1];n.appendChild(e[t.Current]);e[t.Current].title=i;n.appendChild(s[3])}}e.updateCrumbs=s;function i(){const e=r.folderIcon.element({className:m,tag:"span",title:d.PageConfig.getOption("serverRoot")||"Jupyter Server Root",stylesheet:"breadCrumb"});const t=r.ellipsesIcon.element({className:u,tag:"span",stylesheet:"breadCrumb"});const s=document.createElement("span");s.className=u;const i=document.createElement("span");i.className=u;return[e,t,s,i]}e.createCrumbs=i;function n(){const e=[];const t=2;for(let s=0;s<t+2;s++){const t=document.createElement("span");t.textContent="/";e.push(t)}return e}e.createCrumbSeparators=n})(v||(v={}));var y=s("51fH");var w=s("l37l");var E=s("iNl7");var b=s("fBQ3");var C=s("s/A5");var D=s("hGAP");const I="jp-DirListing";const x="jp-DirListing-header";const L="jp-DirListing-headerItem";const k="jp-DirListing-headerItemText";const F="jp-DirListing-headerItemIcon";const P="jp-DirListing-content";const N="jp-DirListing-item";const M="jp-DirListing-itemText";const S="jp-DirListing-itemIcon";const A="jp-DirListing-itemModified";const j="jp-DirListing-editor";const O="jp-id-name";const B="jp-id-modified";const T="application/x-jupyter-icontents";const R="application/x-jupyter-icontentsrich";const U="jp-mod-dropTarget";const z="jp-mod-selected";const V="jp-DragIcon";const K="jp-mod-clipboard";const W="jp-mod-cut";const H="jp-mod-multiSelected";const Y="jp-mod-running";const $="jp-mod-descending";const X=1e3;const q=5;const G=!!navigator.platform.match(/Mac/i);const J="application/vnd.phosphor.widget-factory";class Z extends o.Widget{constructor(e){super({node:(e.renderer||Z.defaultRenderer).createNode()});this._items=[];this._sortedItems=[];this._sortState={direction:"ascending",key:"name"};this._onItemOpened=new C.Signal(this);this._drag=null;this._dragData=null;this._selectTimer=-1;this._isCut=false;this._prevPath="";this._clipboard=[];this._softSelection="";this._selection=Object.create(null);this._searchPrefix="";this._searchPrefixTimer=-1;this._inRename=false;this._isDirty=false;this.addClass(I);this._model=e.model;this._model.fileChanged.connect(this._onFileChanged,this);this._model.refreshed.connect(this._onModelRefreshed,this);this._model.pathChanged.connect(this._onPathChanged,this);this._editNode=document.createElement("input");this._editNode.className=j;this._manager=this._model.manager;this._renderer=e.renderer||Z.defaultRenderer;const t=i.DOMUtils.findElement(this.node,x);this._renderer.populateHeaderNode(t);this._manager.activateRequested.connect(this._onActivateRequested,this)}dispose(){this._items.length=0;this._sortedItems.length=0;this._clipboard.length=0;super.dispose()}get model(){return this._model}get headerNode(){return i.DOMUtils.findElement(this.node,x)}get contentNode(){return i.DOMUtils.findElement(this.node,P)}get renderer(){return this._renderer}get sortState(){return this._sortState}get onItemOpened(){return this._onItemOpened}selectedItems(){const e=this._sortedItems;return(0,a.filter)(e,e=>this._selection[e.name])}sortedItems(){return new a.ArrayIterator(this._sortedItems)}sort(e){this._sortedItems=Q.sort(this.model.items(),e);this._sortState=e;this.update()}rename(){return this._doRename()}cut(){this._isCut=true;this._copy();this.update()}copy(){this._copy()}paste(){if(!this._clipboard.length){this._isCut=false;return Promise.resolve(undefined)}const e=this._model.path;const t=[];(0,a.each)(this._clipboard,s=>{if(this._isCut){const i=s.split("/");const n=i[i.length-1];const r=d.PathExt.join(e,n);t.push(this._model.manager.rename(s,r))}else{t.push(this._model.manager.copy(s,e))}});(0,a.each)(this._items,e=>{e.classList.remove(W)});this._clipboard.length=0;this._isCut=false;this.removeClass(K);return Promise.all(t).then(()=>undefined).catch(e=>{void(0,i.showErrorMessage)("Paste Error",e)})}async delete(){const e=this._sortedItems.filter(e=>this._selection[e.name]);if(!e.length){return}const t=e.length===1?`Are you sure you want to permanently delete: ${e[0].name}?`:`Are you sure you want to permanently delete the ${e.length} `+`files/folders selected?`;const s=await(0,i.showDialog)({title:"Delete",body:t,buttons:[i.Dialog.cancelButton(),i.Dialog.warnButton({label:"Delete"})]});if(!this.isDisposed&&s.button.accept){await this._delete(e.map(e=>e.path))}}duplicate(){const e=this._model.path;const t=[];(0,a.each)(this.selectedItems(),s=>{if(s.type!=="directory"){const i=d.PathExt.join(e,s.name);t.push(this._model.manager.copy(i,e))}});return Promise.all(t).then(()=>undefined).catch(e=>{void(0,i.showErrorMessage)("Duplicate file",e)})}async download(){await Promise.all((0,a.toArray)(this.selectedItems()).filter(e=>e.type!=="directory").map(e=>this._model.download(e.path)))}shutdownKernels(){const e=this._model;const t=this._sortedItems;const s=t.map(e=>e.path);const n=(0,a.toArray)(this._model.sessions()).filter(e=>{const i=a.ArrayExt.firstIndexOf(s,e.path);return this._selection[t[i].name]}).map(t=>e.manager.services.sessions.shutdown(t.id));return Promise.all(n).then(()=>undefined).catch(e=>{void(0,i.showErrorMessage)("Shut down kernel",e)})}selectNext(e=false){let t=-1;const s=Object.keys(this._selection);const i=this._sortedItems;if(s.length===1||e){const e=s[s.length-1];t=a.ArrayExt.findFirstIndex(i,t=>t.name===e);t+=1;if(t===this._items.length){t=0}}else if(s.length===0){t=0}else{const e=s[s.length-1];t=a.ArrayExt.findFirstIndex(i,t=>t.name===e)}if(t!==-1){this._selectItem(t,e);l.ElementExt.scrollIntoViewIfNeeded(this.contentNode,this._items[t])}}selectPrevious(e=false){let t=-1;const s=Object.keys(this._selection);const i=this._sortedItems;if(s.length===1||e){const e=s[0];t=a.ArrayExt.findFirstIndex(i,t=>t.name===e);t-=1;if(t===-1){t=this._items.length-1}}else if(s.length===0){t=this._items.length-1}else{const e=s[0];t=a.ArrayExt.findFirstIndex(i,t=>t.name===e)}if(t!==-1){this._selectItem(t,e);l.ElementExt.scrollIntoViewIfNeeded(this.contentNode,this._items[t])}}selectByPrefix(){const e=this._searchPrefix.toLowerCase();const t=this._sortedItems;const s=a.ArrayExt.findFirstIndex(t,t=>t.name.toLowerCase().substr(0,e.length)===e);if(s!==-1){this._selectItem(s,false);l.ElementExt.scrollIntoViewIfNeeded(this.contentNode,this._items[s])}}isSelected(e){return this._selection[e]===true}modelForClick(e){const t=this._sortedItems;const s=Q.hitTestNodes(this._items,e);if(s!==-1){return t[s]}return undefined}clearSelectedItems(){this._selection=Object.create(null)}async selectItemByName(e){await this.model.refresh();if(this.isDisposed){throw new Error("File browser is disposed.")}const t=this._sortedItems;const s=a.ArrayExt.findFirstIndex(t,t=>t.name===e);if(s===-1){throw new Error("Item does not exist.")}this._selectItem(s,false);b.MessageLoop.sendMessage(this,o.Widget.Msg.UpdateRequest);l.ElementExt.scrollIntoViewIfNeeded(this.contentNode,this._items[s])}handleEvent(e){switch(e.type){case"mousedown":this._evtMousedown(e);break;case"mouseup":this._evtMouseup(e);break;case"mousemove":this._evtMousemove(e);break;case"keydown":this._evtKeydown(e);break;case"click":this._evtClick(e);break;case"dblclick":this._evtDblClick(e);break;case"dragenter":case"dragover":this.addClass("jp-mod-native-drop");e.preventDefault();break;case"dragleave":case"dragend":this.removeClass("jp-mod-native-drop");break;case"drop":this.removeClass("jp-mod-native-drop");this._evtNativeDrop(e);break;case"scroll":this._evtScroll(e);break;case"lm-dragenter":this._evtDragEnter(e);break;case"lm-dragleave":this._evtDragLeave(e);break;case"lm-dragover":this._evtDragOver(e);break;case"lm-drop":this._evtDrop(e);break;default:break}}onAfterAttach(e){super.onAfterAttach(e);const t=this.node;const s=i.DOMUtils.findElement(t,P);t.addEventListener("mousedown",this);t.addEventListener("keydown",this);t.addEventListener("click",this);t.addEventListener("dblclick",this);s.addEventListener("dragenter",this);s.addEventListener("dragover",this);s.addEventListener("dragleave",this);s.addEventListener("dragend",this);s.addEventListener("drop",this);s.addEventListener("scroll",this);s.addEventListener("lm-dragenter",this);s.addEventListener("lm-dragleave",this);s.addEventListener("lm-dragover",this);s.addEventListener("lm-drop",this)}onBeforeDetach(e){super.onBeforeDetach(e);const t=this.node;const s=i.DOMUtils.findElement(t,P);t.removeEventListener("mousedown",this);t.removeEventListener("keydown",this);t.removeEventListener("click",this);t.removeEventListener("dblclick",this);s.removeEventListener("scroll",this);s.removeEventListener("dragover",this);s.removeEventListener("dragover",this);s.removeEventListener("dragleave",this);s.removeEventListener("dragend",this);s.removeEventListener("drop",this);s.removeEventListener("lm-dragenter",this);s.removeEventListener("lm-dragleave",this);s.removeEventListener("lm-dragover",this);s.removeEventListener("lm-drop",this);document.removeEventListener("mousemove",this,true);document.removeEventListener("mouseup",this,true)}onAfterShow(e){if(this._isDirty){this.sort(this.sortState);this.update()}}onUpdateRequest(e){this._isDirty=false;const t=this._sortedItems;const s=this._items;const n=i.DOMUtils.findElement(this.node,P);const r=this._renderer;this.removeClass(H);this.removeClass(z);while(s.length>t.length){n.removeChild(s.pop())}while(s.length<t.length){const e=r.createItemNode();e.classList.add(N);s.push(e);n.appendChild(e)}s.forEach(e=>{e.classList.remove(z);e.classList.remove(Y);e.classList.remove(W)});t.forEach((e,t)=>{const i=s[t];const n=this._manager.registry.getFileTypeForModel(e);r.updateItemNode(i,e,n);if(this._selection[e.name]){i.classList.add(z);if(this._isCut&&this._model.path===this._prevPath){i.classList.add(W)}}i.setAttribute("data-isdir",e.type==="directory"?"true":"false")});const o=Object.keys(this._selection).length;if(o){this.addClass(z);if(o>1){this.addClass(H)}}const l=t.map(e=>e.path);(0,a.each)(this._model.sessions(),e=>{var t;const i=a.ArrayExt.firstIndexOf(l,e.path);const n=s[i];if(n){let s=(t=e.kernel)===null||t===void 0?void 0:t.name;const i=this._model.specs;n.classList.add(Y);if(i&&s){const e=i.kernelspecs[s];s=e?e.display_name:"unknown"}n.title=`${n.title}\nKernel: ${s}`}});this._prevPath=this._model.path}onResize(e){const{width:t}=e.width===-1?this.node.getBoundingClientRect():e;this.toggleClass("jp-DirListing-narrow",t<250)}_evtClick(e){const t=e.target;const s=this.headerNode;if(s.contains(t)){const t=this.renderer.handleHeaderClick(s,e);if(t){this.sort(t)}return}}_evtScroll(e){this.headerNode.scrollLeft=this.contentNode.scrollLeft}_evtMousedown(e){if(e.target===this._editNode){return}if(this._editNode.parentNode){if(this._editNode!==e.target){this._editNode.focus();this._editNode.blur();clearTimeout(this._selectTimer)}else{return}}let t=Q.hitTestNodes(this._items,e);if(t===-1){return}this._handleFileSelect(e);if(e.button!==0){clearTimeout(this._selectTimer)}const s=G&&e.ctrlKey||e.button===2;if(s){return}if(e.button===0){this._dragData={pressX:e.clientX,pressY:e.clientY,index:t};document.addEventListener("mouseup",this,true);document.addEventListener("mousemove",this,true)}}_evtMouseup(e){if(this._softSelection){const t=e.metaKey||e.shiftKey||e.ctrlKey;if(!t&&e.button===0){this.clearSelectedItems();this._selection[this._softSelection]=true;this.update()}this._softSelection=""}if(e.button!==0||!this._drag){document.removeEventListener("mousemove",this,true);document.removeEventListener("mouseup",this,true);return}e.preventDefault();e.stopPropagation()}_evtMousemove(e){e.preventDefault();e.stopPropagation();if(this._drag||!this._dragData){return}const t=this._dragData;const s=Math.abs(e.clientX-t.pressX);const i=Math.abs(e.clientY-t.pressY);if(s<q&&i<q){return}this._startDrag(t.index,e.clientX,e.clientY)}_handleOpen(e){this._onItemOpened.emit(e);if(e.type==="directory"){const t=this._manager.services.contents.localPath(e.path);this._model.cd(`/${t}`).catch(e=>(0,i.showErrorMessage)("Open directory",e))}else{const t=e.path;this._manager.openOrReveal(t)}}_evtKeydown(e){switch(e.keyCode){case 13:{if(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey){return}e.preventDefault();e.stopPropagation();const t=Object.keys(this._selection);const s=t[0];const i=this._sortedItems;const n=a.ArrayExt.findFirstIndex(i,e=>e.name===s);if(n===-1){return}const r=this._sortedItems[n];this._handleOpen(r);break}case 38:this.selectPrevious(e.shiftKey);e.stopPropagation();e.preventDefault();break;case 40:this.selectNext(e.shiftKey);e.stopPropagation();e.preventDefault();break;default:break}if(!this._inRename&&e.key!==undefined&&e.key.length===1){this._searchPrefix+=e.key;clearTimeout(this._searchPrefixTimer);this._searchPrefixTimer=window.setTimeout(()=>{this._searchPrefix=""},X);this.selectByPrefix();e.stopPropagation();e.preventDefault()}}_evtDblClick(e){if(e.button!==0){return}if(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey){return}e.preventDefault();e.stopPropagation();clearTimeout(this._selectTimer);this._editNode.blur();const t=e.target;const s=a.ArrayExt.findFirstIndex(this._items,e=>e.contains(t));if(s===-1){return}const i=this._sortedItems[s];this._handleOpen(i)}_evtNativeDrop(e){var t;const s=(t=e.dataTransfer)===null||t===void 0?void 0:t.files;if(!s||s.length===0){return}e.preventDefault();for(let i=0;i<s.length;i++){void this._model.upload(s[i])}}_evtDragEnter(e){if(e.mimeData.hasData(T)){const t=Q.hitTestNodes(this._items,e);if(t===-1){return}const s=this._sortedItems[t];if(s.type!=="directory"||this._selection[s.name]){return}const i=e.target;i.classList.add(U);e.preventDefault();e.stopPropagation()}}_evtDragLeave(e){e.preventDefault();e.stopPropagation();const t=i.DOMUtils.findElement(this.node,U);if(t){t.classList.remove(U)}}_evtDragOver(e){e.preventDefault();e.stopPropagation();e.dropAction=e.proposedAction;const t=i.DOMUtils.findElement(this.node,U);if(t){t.classList.remove(U)}const s=Q.hitTestNodes(this._items,e);this._items[s].classList.add(U)}_evtDrop(e){e.preventDefault();e.stopPropagation();clearTimeout(this._selectTimer);if(e.proposedAction==="none"){e.dropAction="none";return}if(!e.mimeData.hasData(T)){return}let t=e.target;while(t&&t.parentElement){if(t.classList.contains(U)){t.classList.remove(U);break}t=t.parentElement}const s=a.ArrayExt.firstIndexOf(this._items,t);const n=this._sortedItems;let r=this._model.path;if(n[s].type==="directory"){r=d.PathExt.join(r,n[s].name)}const o=this._manager;const l=[];const h=e.mimeData.getData(T);if(e.ctrlKey&&e.proposedAction==="move"){e.dropAction="copy"}else{e.dropAction=e.proposedAction}for(const i of h){const t=o.services.contents.localPath(i);const s=d.PathExt.basename(t);const n=d.PathExt.join(r,s);if(n===i){continue}if(e.dropAction==="copy"){l.push(o.copy(i,r))}else{l.push((0,c.renameFile)(o,i,n))}}Promise.all(l).catch(e=>{void(0,i.showErrorMessage)("Error while copying/moving files",e)})}_startDrag(e,t,s){let i=Object.keys(this._selection);const n=this._items[e];const r=this._sortedItems;let o;let l;if(!n.classList.contains(z)){l=r[e];i=[l.name];o=[l]}else{const e=i[0];l=(0,a.find)(r,t=>t.name===e);o=(0,a.toArray)(this.selectedItems())}if(!l){return}const c=this._manager.registry.getFileTypeForModel(l);const h=this.renderer.createDragImage(n,i.length,c);this._drag=new E.Drag({dragImage:h,mimeData:new w.MimeData,supportedActions:"move",proposedAction:"move"});const m=this._model.path;const u=(0,a.toArray)((0,a.map)(i,e=>d.PathExt.join(m,e)));this._drag.mimeData.setData(T,u);const p=this.model.manager.services;for(const a of o){this._drag.mimeData.setData(R,{model:a,withContent:async()=>await p.contents.get(a.path)})}if(l&&l.type!=="directory"){const e=u.slice(1).reverse();this._drag.mimeData.setData(J,()=>{if(!l){return}const t=l.path;let s=this._manager.findWidget(t);if(!s){s=this._manager.open(l.path)}if(e.length){const t=new w.PromiseDelegate;void t.promise.then(()=>{let t=s;e.forEach(e=>{const s={ref:t===null||t===void 0?void 0:t.id,mode:"tab-after"};t=this._manager.openOrReveal(e,void 0,void 0,s);this._manager.openOrReveal(l.path)})});t.resolve(void 0)}return s})}document.removeEventListener("mousemove",this,true);document.removeEventListener("mouseup",this,true);clearTimeout(this._selectTimer);void this._drag.start(t,s).then(e=>{this._drag=null;clearTimeout(this._selectTimer)})}_handleFileSelect(e){const t=this._sortedItems;const s=Q.hitTestNodes(this._items,e);clearTimeout(this._selectTimer);if(s===-1){return}this._softSelection="";const i=t[s].name;const n=Object.keys(this._selection);if(G&&e.metaKey||!G&&e.ctrlKey){if(this._selection[i]){delete this._selection[i]}else{this._selection[i]=true}}else if(e.shiftKey){this._handleMultiSelect(n,s)}else if(i in this._selection&&n.length>1){this._softSelection=i}else{this.clearSelectedItems();this._selection[i]=true}this.update()}_handleMultiSelect(e,t){const s=this._sortedItems;let i=-1;for(let n=0;n<this._items.length;n++){if(n===t){continue}const r=s[n].name;if(e.indexOf(r)!==-1){if(i===-1){i=n}else{if(Math.abs(t-n)<Math.abs(i-n)){i=n}}}}if(i===-1){i=0}for(let n=0;n<this._items.length;n++){if(i>=n&&t<=n||i<=n&&t>=n){this._selection[s[n].name]=true}}}_copy(){this._clipboard.length=0;(0,a.each)(this.selectedItems(),e=>{this._clipboard.push(e.path)})}async _delete(e){await Promise.all(e.map(e=>this._model.manager.deleteFile(e).catch(e=>{void(0,i.showErrorMessage)("Delete Failed",e)})))}_doRename(){this._inRename=true;const e=this._sortedItems;const t=Object.keys(this._selection)[0];const s=a.ArrayExt.findFirstIndex(e,e=>e.name===t);const n=this._items[s];const r=e[s];const o=this.renderer.getNameNode(n);const l=r.name;this._editNode.value=l;this._selectItem(s,false);return Q.doRename(o,this._editNode).then(e=>{this.node.focus();if(!e||e===l){this._inRename=false;return l}if(!(0,c.isValidFileName)(e)){void(0,i.showErrorMessage)("Rename Error",Error(`"${e}" is not a valid name for a file. `+`Names must have nonzero length, `+`and cannot include "/", "\\", or ":"`));this._inRename=false;return l}if(this.isDisposed){this._inRename=false;throw new Error("File browser is disposed.")}const t=this._manager;const s=d.PathExt.join(this._model.path,l);const n=d.PathExt.join(this._model.path,e);const r=(0,c.renameFile)(t,s,n);return r.catch(e=>{if(e!=="File not renamed"){void(0,i.showErrorMessage)("Rename Error",e)}this._inRename=false;return l}).then(()=>{if(this.isDisposed){this._inRename=false;throw new Error("File browser is disposed.")}if(this._inRename){void this.selectItemByName(e)}this._inRename=false;return e})})}_selectItem(e,t){const s=this._sortedItems;if(!t){this.clearSelectedItems()}const i=s[e].name;this._selection[i]=true;this.update()}_onModelRefreshed(){const e=Object.keys(this._selection);this.clearSelectedItems();(0,a.each)(this._model.items(),t=>{const s=t.name;if(e.indexOf(s)!==-1){this._selection[s]=true}});if(this.isVisible){this.sort(this.sortState)}else{this._isDirty=true}}_onPathChanged(){this.clearSelectedItems();this.sort(this.sortState)}_onFileChanged(e,t){const s=t.newValue;if(!s){return}const i=s.name;if(t.type!=="new"||!i){return}void this.selectItemByName(i).then(()=>{if(!this.isDisposed&&s.type==="directory"){return this._doRename()}}).catch(()=>{})}_onActivateRequested(e,t){const s=d.PathExt.dirname(t);if(s!==this._model.path){return}const i=d.PathExt.basename(t);this.selectItemByName(i).catch(()=>{})}}(function(e){class t{createNode(){const e=document.createElement("div");const t=document.createElement("div");const s=document.createElement("ul");s.className=P;t.className=x;e.appendChild(t);e.appendChild(s);e.tabIndex=1;return e}populateHeaderNode(e){const t=this._createHeaderItemNode("Name");const s=this._createHeaderItemNode("Last Modified");t.classList.add(O);t.classList.add(z);s.classList.add(B);e.appendChild(t);e.appendChild(s);Q.updateCaret(i.DOMUtils.findElement(t,F),"right","up")}handleHeaderClick(e,t){const s=i.DOMUtils.findElement(e,O);const n=i.DOMUtils.findElement(e,B);const r={direction:"ascending",key:"name"};const o=t.target;if(s.contains(o)){const e=i.DOMUtils.findElement(n,F);const t=i.DOMUtils.findElement(s,F);if(s.classList.contains(z)){if(!s.classList.contains($)){r.direction="descending";s.classList.add($);Q.updateCaret(t,"right","down")}else{s.classList.remove($);Q.updateCaret(t,"right","up")}}else{s.classList.remove($);Q.updateCaret(t,"right","up")}s.classList.add(z);n.classList.remove(z);n.classList.remove($);Q.updateCaret(e,"left");return r}if(n.contains(o)){const e=i.DOMUtils.findElement(n,F);const t=i.DOMUtils.findElement(s,F);r.key="last_modified";if(n.classList.contains(z)){if(!n.classList.contains($)){r.direction="descending";n.classList.add($);Q.updateCaret(e,"left","down")}else{n.classList.remove($);Q.updateCaret(e,"left","up")}}else{n.classList.remove($);Q.updateCaret(e,"left","up")}n.classList.add(z);s.classList.remove(z);s.classList.remove($);Q.updateCaret(t,"right");return r}return r}createItemNode(){const e=document.createElement("li");const t=document.createElement("span");const s=document.createElement("span");const i=document.createElement("span");t.className=S;s.className=M;i.className=A;e.appendChild(t);e.appendChild(s);e.appendChild(i);return e}updateItemNode(e,t,s=y.DocumentRegistry.defaultTextFileType){const{icon:n,iconClass:o,name:l}=s;const c=i.DOMUtils.findElement(e,S);const h=i.DOMUtils.findElement(e,M);const m=i.DOMUtils.findElement(e,A);r.LabIcon.resolveElement({icon:n,iconClass:(0,r.classes)(o,"jp-Icon"),container:c,className:S,stylesheet:"listing"});let u="Name: "+t.name;if(t.size!==null&&t.size!==undefined){u+="\nSize: "+Q.formatFileSize(t.size,1,1024)}if(t.path){const e=d.PathExt.dirname(t.path);if(e){u+="\nPath: "+e.substr(0,50);if(e.length>50){u+="..."}}}if(t.created){u+="\nCreated: "+d.Time.format(new Date(t.created),"YYYY-MM-DD HH:mm:ss")}if(t.last_modified){u+="\nModified: "+d.Time.format(new Date(t.last_modified),"YYYY-MM-DD HH:mm:ss")}u+="\nWritable: "+t.writable;e.title=u;e.setAttribute("data-file-type",l);if(t.name.startsWith(".")){e.setAttribute("data-is-dot","true")}else{e.removeAttribute("data-is-dot")}if(h){const e=!t.indices?[]:t.indices;let s=a.StringExt.highlight(t.name,e,D.h.mark);D.VirtualDOM.render(D.h.div(s),h)}let p="";let f="";if(t.last_modified){p=d.Time.formatHuman(new Date(t.last_modified));f=d.Time.format(new Date(t.last_modified),"lll")}m.textContent=p;m.title=f}getNameNode(e){return i.DOMUtils.findElement(e,M)}createDragImage(e,t,s){const n=e.cloneNode(true);const r=i.DOMUtils.findElement(n,A);const o=i.DOMUtils.findElement(n,S);n.removeChild(r);if(!s){o.textContent="";o.className=""}else{o.textContent=s.iconLabel||"";o.className=s.iconClass||""}o.classList.add(V);if(t>1){const e=i.DOMUtils.findElement(n,M);e.textContent=t+" Items"}return n}_createHeaderItemNode(e){const t=document.createElement("div");const s=document.createElement("span");const i=document.createElement("span");t.className=L;s.className=k;i.className=F;s.textContent=e;t.appendChild(s);t.appendChild(i);return t}}e.Renderer=t;e.defaultRenderer=new t})(Z||(Z={}));var Q;(function(e){function t(e,t){const s=e.parentElement;s.replaceChild(t,e);t.focus();const i=t.value.lastIndexOf(".");if(i===-1){t.setSelectionRange(0,t.value.length)}else{t.setSelectionRange(0,i)}return new Promise((i,n)=>{t.onblur=()=>{s.replaceChild(e,t);i(t.value)};t.onkeydown=e=>{switch(e.keyCode){case 13:e.stopPropagation();e.preventDefault();t.blur();break;case 27:e.stopPropagation();e.preventDefault();t.blur();break;case 38:e.stopPropagation();e.preventDefault();if(t.selectionStart!==t.selectionEnd){t.selectionStart=t.selectionEnd=0}break;case 40:e.stopPropagation();e.preventDefault();if(t.selectionStart!==t.selectionEnd){t.selectionStart=t.selectionEnd=t.value.length}break;default:break}}})}e.doRename=t;function s(e,t){const s=(0,a.toArray)(e);const i=t.direction==="descending"?1:-1;if(t.key==="last_modified"){s.sort((e,t)=>{const s=e.type==="directory"?0:1;const n=t.type==="directory"?0:1;const r=new Date(e.last_modified).getTime();const o=new Date(t.last_modified).getTime();return s-n||(r-o)*i})}else{s.sort((e,t)=>{const s=e.type==="directory"?0:1;const n=t.type==="directory"?0:1;return s-n||t.name.localeCompare(e.name)*i})}return s}e.sort=s;function i(e,t){return a.ArrayExt.findFirstIndex(e,e=>l.ElementExt.hitTest(e,t.clientX,t.clientY)||t.target===e)}e.hitTestNodes=i;function n(e,t,s){if(e===0){return"0 Bytes"}const i=t||2;const n=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"];const r=Math.floor(Math.log(e)/Math.log(s));if(r>=0&&r<n.length){return parseFloat((e/Math.pow(s,r)).toFixed(i))+" "+n[r]}else{return String(e)}}e.formatFileSize=n;function o(e,t,s){if(s){(s==="down"?r.caretDownIcon:r.caretUpIcon).element({container:e,tag:"span",stylesheet:"listingHeaderItem",float:t})}else{r.LabIcon.remove(e);e.className=F}}e.updateCaret=o})(Q||(Q={}));class ee extends i.ToolbarButton{constructor(e){super({icon:r.fileUploadIcon,onClick:()=>{this._input.click()},tooltip:"Upload Files"});this._onInputChanged=()=>{const e=Array.prototype.slice.call(this._input.files);const t=e.map(e=>this.fileBrowserModel.upload(e));void Promise.all(t).catch(e=>{void(0,i.showErrorMessage)("Upload Error",e)})};this._onInputClicked=()=>{this._input.value=""};this._input=te.createUploadInput();this.fileBrowserModel=e.model;this._input.onclick=this._onInputClicked;this._input.onchange=this._onInputChanged;this.addClass("jp-id-upload")}}var te;(function(e){function t(){const e=document.createElement("input");e.type="file";e.multiple=true;return e}e.createUploadInput=t})(te||(te={}));var se=s("yR1x");var ie=s.n(se);function ne(e,t){let s=`${e.name}`;let i=Infinity;let n=null;const r=/\b\w/g;let o=true;while(o){let e=r.exec(s);if(!e){break}let o=a.StringExt.matchSumOfDeltas(s,t,e.index);if(!o){break}if(o&&o.score<=i){i=o.score;n=o.indices}}if(!n||i===Infinity){return null}return{score:i,indices:n,item:e}}const re=e=>{const[t,s]=(0,se.useState)("");if(e.forceRefresh){(0,se.useEffect)(()=>{e.listing.model.setFilter(e=>true)},[])}const i=t=>{const i=t.target;s(i.value);e.listing.model.setFilter(t=>{if(e.useFuzzyFilter){let e=ne(t,i.value);if(!e){t.indices=[];return false}t.indices=e.indices;return true}const s=t.name.indexOf(i.value);if(s===-1){t.indices=[];return false}t.indices=[...Array(i.value.length).keys()].map(e=>e+s);return true})};return ie().createElement(r.InputGroup,{type:"text",rightIcon:"ui-components:search",placeholder:e.placeholder,onChange:i,value:t})};const oe=e=>i.ReactWidget.create(ie().createElement(re,{listing:e.listing,useFuzzyFilter:e.useFuzzyFilter,placeholder:e.placeholder,forceRefresh:e.forceRefresh}));const ae="jp-FileBrowser";const le="jp-FileBrowser-crumbs";const de="jp-FileBrowser-filterBox";const ce="jp-FileBrowser-toolbar";const he="jp-FileBrowser-listing";class me extends o.Widget{constructor(e){super();this._useFuzzyFilter=true;this.addClass(ae);this.id=e.id;const t=this.model=e.model;const s=e.renderer;t.connectionFailure.connect(this._onConnectionFailure,this);this._manager=t.manager;this._crumbs=new g({model:t});this.toolbar=new i.Toolbar;this._directoryPending=false;const n=new i.ToolbarButton({icon:r.newFolderIcon,onClick:()=>{this.createNewDirectory()},tooltip:"New Folder"});const a=new ee({model:t});const l=new i.ToolbarButton({icon:r.refreshIcon,onClick:()=>{void t.refresh()},tooltip:"Refresh File List"});this.toolbar.addItem("newFolder",n);this.toolbar.addItem("upload",a);this.toolbar.addItem("refresher",l);this._listing=new Z({model:t,renderer:s});this._filenameSearcher=oe({listing:this._listing,useFuzzyFilter:this._useFuzzyFilter,placeholder:"Filter files by name"});this._crumbs.addClass(le);this.toolbar.addClass(ce);this._filenameSearcher.addClass(de);this._listing.addClass(he);this.layout=new o.PanelLayout;this.layout.addWidget(this.toolbar);this.layout.addWidget(this._filenameSearcher);this.layout.addWidget(this._crumbs);this.layout.addWidget(this._listing);if(e.restore!==false){void t.restore(this.id)}}selectedItems(){return this._listing.selectedItems()}async selectItemByName(e){await this._listing.selectItemByName(e)}clearSelectedItems(){this._listing.clearSelectedItems()}rename(){return this._listing.rename()}cut(){this._listing.cut()}copy(){this._listing.copy()}paste(){return this._listing.paste()}createNewDirectory(){if(this._directoryPending===true){return}this._directoryPending=true;void this._manager.newUntitled({path:this.model.path,type:"directory"}).then(async e=>{await this._listing.selectItemByName(e.name);this._directoryPending=false}).catch(e=>{this._directoryPending=false})}delete(){return this._listing.delete()}duplicate(){return this._listing.duplicate()}download(){return this._listing.download()}shutdownKernels(){return this._listing.shutdownKernels()}selectNext(){this._listing.selectNext()}selectPrevious(){this._listing.selectPrevious()}modelForClick(e){return this._listing.modelForClick(e)}_onConnectionFailure(e,t){if(t instanceof n.ServerConnection.ResponseError&&t.response.status===404){const e="Directory not found";t.message=`Directory not found: "${this.model.path}"`;void(0,i.showErrorMessage)(e,t)}}get navigateToCurrentDirectory(){return this._navigateToCurrentDirectory}set navigateToCurrentDirectory(e){this._navigateToCurrentDirectory=e}set useFuzzyFilter(e){this._useFuzzyFilter=e;this._filenameSearcher=oe({listing:this._listing,useFuzzyFilter:this._useFuzzyFilter,placeholder:"Filter files by name",forceRefresh:true});this._filenameSearcher.addClass(de);this.layout.removeWidget(this._filenameSearcher);this.layout.removeWidget(this._crumbs);this.layout.removeWidget(this._listing);this.layout.addWidget(this._filenameSearcher);this.layout.addWidget(this._crumbs);this.layout.addWidget(this._listing)}}var ue=s("tUVX");const pe=new w.Token("@jupyterlab/filebrowser:IFileBrowserFactory");var fe=s("rI8a");const _e=1e4;const ge=15*1024*1024;const ve=1024*1024;class ye{constructor(e){var t;this._connectionFailure=new C.Signal(this);this._fileChanged=new C.Signal(this);this._items=[];this._key="";this._pathChanged=new C.Signal(this);this._paths=new Set;this._pending=null;this._pendingPath=null;this._refreshed=new C.Signal(this);this._sessions=[];this._state=null;this._isDisposed=false;this._restored=new w.PromiseDelegate;this._uploads=[];this._uploadChanged=new C.Signal(this);this.manager=e.manager;this._driveName=e.driveName||"";const s=this._driveName?this._driveName+":":"";this._model={path:s,name:d.PathExt.basename(s),type:"directory",content:undefined,writable:false,created:"unknown",last_modified:"unknown",mimetype:"text/plain",format:"text"};this._state=e.state||null;const i=e.refreshInterval||_e;const{services:n}=e.manager;n.contents.fileChanged.connect(this._onFileChanged,this);n.sessions.runningChanged.connect(this._onRunningChanged,this);this._unloadEventListener=e=>{if(this._uploads.length>0){const t="Files still uploading";e.returnValue=t;return t}};window.addEventListener("beforeunload",this._unloadEventListener);this._poll=new fe.Poll({auto:(t=e.auto)!==null&&t!==void 0?t:true,name:"@jupyterlab/filebrowser:Model",factory:()=>this.cd("."),frequency:{interval:i,backoff:true,max:300*1e3},standby:"when-hidden"})}get connectionFailure(){return this._connectionFailure}get driveName(){return this._driveName}get restored(){return this._restored.promise}get fileChanged(){return this._fileChanged}get path(){return this._model?this._model.path:""}get pathChanged(){return this._pathChanged}get refreshed(){return this._refreshed}get specs(){return this.manager.services.kernelspecs.specs}get isDisposed(){return this._isDisposed}get uploadChanged(){return this._uploadChanged}uploads(){return new a.ArrayIterator(this._uploads)}dispose(){if(this.isDisposed){return}window.removeEventListener("beforeunload",this._unloadEventListener);this._isDisposed=true;this._poll.dispose();this._sessions.length=0;this._items.length=0;C.Signal.clearData(this)}items(){return new a.ArrayIterator(this._items)}sessions(){return new a.ArrayIterator(this._sessions)}async refresh(){await this._poll.refresh();await this._poll.tick;this._refreshed.emit(void 0)}async cd(e="."){if(e!=="."){e=this.manager.services.contents.resolvePath(this._model.path,e)}else{e=this._pendingPath||this._model.path}if(this._pending){if(e===this._pendingPath){return this._pending}await this._pending}const t=this.path;const s={content:true};this._pendingPath=e;if(t!==e){this._sessions.length=0}const i=this.manager.services;this._pending=i.contents.get(e,s).then(s=>{if(this.isDisposed){return}this._handleContents(s);this._pendingPath=null;this._pending=null;if(t!==e){if(this._state&&this._key){void this._state.save(this._key,{path:e})}this._pathChanged.emit({name:"path",oldValue:t,newValue:e})}this._onRunningChanged(i.sessions,i.sessions.running());this._refreshed.emit(void 0)}).catch(e=>{this._pendingPath=null;this._pending=null;if(e.response&&e.response.status===404){e.message=`Directory not found: "${this._model.path}"`;console.error(e);this._connectionFailure.emit(e);return this.cd("/")}else{this._connectionFailure.emit(e)}});return this._pending}async download(e){const t=await this.manager.services.contents.getDownloadUrl(e);const s=document.createElement("a");s.href=t;s.download="";document.body.appendChild(s);s.click();document.body.removeChild(s);return void 0}async restore(e,t=true){const{manager:s}=this;const i=`file-browser-${e}:cwd`;const n=this._state;const r=!!this._key;if(r){return}this._key=i;if(!t||!n){this._restored.resolve(undefined);return}await s.services.ready;try{const e=await n.fetch(i);if(!e){this._restored.resolve(undefined);return}const t=e["path"];const r=s.services.contents.localPath(t);await s.services.contents.get(t);await this.cd(r)}catch(o){await n.remove(i)}this._restored.resolve(undefined)}async upload(e){const t=d.PageConfig.getNotebookVersion()>=[5,1,0];const s=e.size>ge;if(s&&!t){const t=`Cannot upload file (>${ge/(1024*1024)} MB). ${e.name}`;console.warn(t);throw t}const i="File not uploaded";if(s&&!(await this._shouldUploadLarge(e))){throw"Cancelled large file upload"}await this._uploadCheckDisposed();await this.refresh();await this._uploadCheckDisposed();if((0,a.find)(this._items,t=>t.name===e.name)&&!(await(0,c.shouldOverwrite)(e.name))){throw i}await this._uploadCheckDisposed();const n=t&&e.size>ve;return await this._upload(e,n)}async _shouldUploadLarge(e){const{button:t}=await(0,i.showDialog)({title:"Large file size warning",body:`The file size is ${Math.round(e.size/(1024*1024))} MB. Do you still want to upload it?`,buttons:[i.Dialog.cancelButton(),i.Dialog.warnButton({label:"Upload"})]});return t.accept}async _upload(e,t){let s=this._model.path;s=s?s+"/"+e.name:e.name;const i=e.name;const n="file";const r="base64";const o=async(t,o)=>{await this._uploadCheckDisposed();const a=new FileReader;a.readAsDataURL(t);await new Promise((t,s)=>{a.onload=t;a.onerror=t=>s(`Failed to upload "${e.name}":`+t)});await this._uploadCheckDisposed();const l=a.result.split(",")[1];const d={type:n,format:r,name:i,chunk:o,content:l};return await this.manager.services.contents.save(s,d)};if(!t){try{return await o(e)}catch(c){a.ArrayExt.removeFirstWhere(this._uploads,t=>e.name===t.path);throw c}}let l;let d={path:s,progress:0};this._uploadChanged.emit({name:"start",newValue:d,oldValue:null});for(let h=0;!l;h+=ve){const t=h+ve;const i=t>=e.size;const n=i?-1:t/ve;const r={path:s,progress:h/e.size};this._uploads.splice(this._uploads.indexOf(d));this._uploads.push(r);this._uploadChanged.emit({name:"update",newValue:r,oldValue:d});d=r;let m;try{m=await o(e.slice(h,t),n)}catch(c){a.ArrayExt.removeFirstWhere(this._uploads,t=>e.name===t.path);this._uploadChanged.emit({name:"failure",newValue:d,oldValue:null});throw c}if(i){l=m}}this._uploads.splice(this._uploads.indexOf(d));this._uploadChanged.emit({name:"finish",newValue:null,oldValue:d});return l}_uploadCheckDisposed(){if(this.isDisposed){return Promise.reject("Filemanager disposed. File upload canceled")}return Promise.resolve()}_handleContents(e){this._model={name:e.name,path:e.path,type:e.type,content:undefined,writable:e.writable,created:e.created,last_modified:e.last_modified,mimetype:e.mimetype,format:e.format};this._items=e.content;this._paths.clear();e.content.forEach(e=>{this._paths.add(e.path)})}_onRunningChanged(e,t){this._populateSessions(t);this._refreshed.emit(void 0)}_onFileChanged(e,t){const s=this._model.path;const{sessions:i}=this.manager.services;const{oldValue:n,newValue:r}=t;const o=n&&n.path&&d.PathExt.dirname(n.path)===s?n:r&&r.path&&d.PathExt.dirname(r.path)===s?r:undefined;if(o){void this._poll.refresh();this._populateSessions(i.running());this._fileChanged.emit(t);return}}_populateSessions(e){this._sessions.length=0;(0,a.each)(e,e=>{if(this._paths.has(e.path)){this._sessions.push(e)}})}}class we extends ye{constructor(e){super(e);this._filter=e.filter?e.filter:e=>true}items(){return(0,a.filter)(super.items(),(e,t)=>{if(e.type==="directory"){return true}else{return this._filter(e)}})}setFilter(e){this._filter=e;void this.refresh()}}const Ee="jp-Open-Dialog";var be;(function(e){function t(e){const t={title:e.title,buttons:[i.Dialog.cancelButton(),i.Dialog.okButton({label:"Select"})],focusNodeSelector:e.focusNodeSelector,host:e.host,renderer:e.renderer,body:new Ce(e.manager,e.filter)};const s=new i.Dialog(t);return s.launch()}e.getOpenFiles=t;function s(e){return t(Object.assign(Object.assign({},e),{filter:e=>false}))}e.getExistingDirectory=s})(be||(be={}));class Ce extends o.Widget{constructor(e,t){super();this.addClass(Ee);this._browser=De.createFilteredFileBrowser("filtered-file-browser-dialog",e,t);const s=new o.PanelLayout;s.addWidget(this._browser);this.layout=s}getValue(){const e=(0,a.toArray)(this._browser.selectedItems());if(e.length===0){return[{path:this._browser.model.path,name:d.PathExt.basename(this._browser.model.path),type:"directory",content:undefined,writable:false,created:"unknown",last_modified:"unknown",mimetype:"text/plain",format:"text"}]}else{return e}}}var De;(function(e){e.createFilteredFileBrowser=(e,t,s,i={})=>{const n=new we({manager:t,filter:s,driveName:i.driveName,refreshInterval:i.refreshInterval});const r=new me({id:e,model:n});return r}})(De||(De={}));const Ie=4;function xe(e){return ie().createElement(ue.GroupItem,{spacing:Ie},ie().createElement(ue.TextItem,{source:"Uploading…"}),ie().createElement(ue.ProgressBar,{percentage:e.upload}))}const Le=2e3;class ke extends i.VDomRenderer{constructor(e){super(new ke.Model(e.tracker.currentWidget&&e.tracker.currentWidget.model));this._onBrowserChange=(e,t)=>{if(t===null){this.model.browserModel=null}else{this.model.browserModel=t.model}};this._tracker=e.tracker;this._tracker.currentChanged.connect(this._onBrowserChange)}render(){const e=this.model.items;if(e.length>0){const e=this.model.items[0];if(e.complete){return ie().createElement(ue.TextItem,{source:"Complete!"})}else{return ie().createElement(xe,{upload:this.model.items[0].progress})}}else{return ie().createElement(xe,{upload:100})}}dispose(){super.dispose();this._tracker.currentChanged.disconnect(this._onBrowserChange)}}(function(e){class t extends i.VDomModel{constructor(e){super();this._uploadChanged=(e,t)=>{if(t.name==="start"){this._items.push({path:t.newValue.path,progress:t.newValue.progress*100,complete:false})}else if(t.name==="update"){const e=a.ArrayExt.findFirstIndex(this._items,e=>e.path===t.oldValue.path);if(e!==-1){this._items[e].progress=t.newValue.progress*100}}else if(t.name==="finish"){const e=a.ArrayExt.findFirstIndex(this._items,e=>e.path===t.oldValue.path);if(e!==-1){this._items[e].complete=true;setTimeout(()=>{a.ArrayExt.removeAt(this._items,e);this.stateChanged.emit(void 0)},Le)}}else if(t.name==="failure"){a.ArrayExt.removeFirstWhere(this._items,e=>e.path===t.newValue.path)}this.stateChanged.emit(void 0)};this._items=[];this._browserModel=null;this.browserModel=e}get items(){return this._items}get browserModel(){return this._browserModel}set browserModel(e){const t=this._browserModel;if(t){t.uploadChanged.disconnect(this._uploadChanged)}this._browserModel=e;this._items=[];if(this._browserModel!==null){this._browserModel.uploadChanged.connect(this._uploadChanged)}this.stateChanged.emit(void 0)}}e.Model=t})(ke||(ke={}))}}]);