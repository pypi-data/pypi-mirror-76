(window["webpackJsonp_jupyterlab_application_top"]=window["webpackJsonp_jupyterlab_application_top"]||[]).push([[4444,7048],{GDJP:(t,e,n)=>{"use strict";n.r(e);n.d(e,{IHTMLViewerTracker:()=>_,HTMLViewer:()=>f,HTMLViewerFactory:()=>y});var r=n("V3w5");var s=n.n(r);var i=n("0c61");var o=n.n(i);var a=n("51fH");var c=n.n(a);var l=n("Sxpi");var h=n.n(l);var d=n("l37l");var u=n.n(d);var m=n("s/A5");var p=n.n(m);var w=n("yR1x");var b=n.n(w);const _=new d.Token("@jupyterlab/htmlviewer:IHTMLViewerTracker");const g=1e3;const v="jp-HTMLViewer";class f extends a.DocumentWidget{constructor(t){super(Object.assign(Object.assign({},t),{content:new r.IFrame({sandbox:["allow-same-origin"]})}));this._renderPending=false;this._parser=new DOMParser;this._monitor=null;this._objectUrl="";this._trustedChanged=new m.Signal(this);this.content.addClass(v);void this.context.ready.then(()=>{this.update();this._monitor=new i.ActivityMonitor({signal:this.context.model.contentChanged,timeout:g});this._monitor.activityStopped.connect(this.update,this)});this.toolbar.addItem("refresh",new r.ToolbarButton({icon:l.refreshIcon,onClick:async()=>{if(!this.context.model.dirty){await this.context.revert();this.update()}},tooltip:"Rerender HTML Document"}));this.toolbar.addItem("trust",r.ReactWidget.create(w.createElement(x.TrustButtonComponent,{htmlDocument:this})))}get trusted(){return this.content.sandbox.indexOf("allow-scripts")!==-1}set trusted(t){if(this.trusted===t){return}if(t){this.content.sandbox=x.trusted}else{this.content.sandbox=x.untrusted}this.content.url=this.content.url;this._trustedChanged.emit(t)}get trustedChanged(){return this._trustedChanged}dispose(){if(this._objectUrl){try{URL.revokeObjectURL(this._objectUrl)}catch(t){}}super.dispose()}onUpdateRequest(){if(this._renderPending){return}this._renderPending=true;void this._renderModel().then(()=>this._renderPending=false)}async _renderModel(){let t=this.context.model.toString();t=await this._setBase(t);const e=new Blob([t],{type:"text/html"});const n=this._objectUrl;this._objectUrl=URL.createObjectURL(e);this.content.url=this._objectUrl;if(n){try{URL.revokeObjectURL(n)}catch(r){}}return}async _setBase(t){const e=this._parser.parseFromString(t,"text/html");let n=e.querySelector("base");if(!n){n=e.createElement("base");e.head.insertBefore(n,e.head.firstChild)}const r=this.context.path;const s=await this.context.urlResolver.getDownloadUrl(r);n.href=s;n.target="_self";return e.documentElement.innerHTML}}class y extends a.ABCWidgetFactory{createNewWidget(t){return new f({context:t})}}var x;(function(t){t.untrusted=[];t.trusted=["allow-scripts"];function e(t){return w.createElement(r.UseSignal,{signal:t.htmlDocument.trustedChanged,initialSender:t.htmlDocument},e=>w.createElement(r.ToolbarButtonComponent,{className:"",onClick:()=>t.htmlDocument.trusted=!t.htmlDocument.trusted,tooltip:`Whether the HTML file is trusted.\nTrusting the file allows scripts to run in it,\nwhich may result in security risks.\nOnly enable for files you trust.`,label:t.htmlDocument.trusted?"Distrust HTML":"Trust HTML"}))}t.TrustButtonComponent=e})(x||(x={}))}}]);