(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[85],{1596:function(t,e,n){"use strict";var r=n(15),a=n.n(r),c=n(9),o=n.n(c),i=n(10),u=n.n(i),s=n(11),l=n.n(s),f=n(12),p=n.n(f),d=n(6),b=n.n(d),h=n(1),y=n.n(h),m=n(113),O=n.n(m),v=n(35),j=n(0);function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var D=function(t){l()(r,t);var e,n=(e=r,function(){var t,n=b()(e);if(g()){var r=b()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return p()(this,t)});function r(){var t;o()(this,r);for(var e=arguments.length,a=new Array(e),c=0;c<e;c++)a[c]=arguments[c];return(t=n.call.apply(n,[this].concat(a))).getFormat=function(e){var n=e.clock24Hours,r=t.props,a=r.dateOnly,c=r.timeOnly,o=r.seconds,i=r.shortDate,u=r.timeAndDate;return a?"LL":u?"MMM DD, LT":c?"LT":i?"MM/DD/YYYY":n?"MMMM D YYYY HH:mm:ss z":o?"ll LTS z":"lll"},t}return u()(r,[{key:"render",value:function(){var t,e=this.props,n=e.date,r=e.utc,c=(e.seconds,e.shortDate,e.dateOnly,e.timeOnly,e.timeAndDate,a()(e,["date","utc","seconds","shortDate","dateOnly","timeOnly","timeAndDate"])),o=v.default.get("user"),i=null==o?void 0:o.options,u=this.getFormat(i);return Object(j.f)("time",c,r?O.a.utc(n).format(u):O.a.tz(n,null!==(t=null==i?void 0:i.timezone)&&void 0!==t?t:"").format(u))}}]),r}(y.a.Component);D.displayName="DateTime",D.defaultProps={seconds:!0},e.a=D},1634:function(t,e,n){"use strict";n(1);var r=n(25),a=n(329),c=n(0);function o(t){var e=t.className,n=t.bytes;return Object(c.f)("span",{className:e},Object(a.a)({value:Object(r.j)(n),fixed:"xx KB"}))}o.displayName="FileSize",e.a=o},1757:function(t,e,n){"use strict";var r=n(9),a=n.n(r),c=n(10),o=n.n(c),i=n(11),u=n.n(i),s=n(12),l=n.n(s),f=n(6),p=n.n(f),d=n(1),b=n.n(d),h=n(35),y=n(78);function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var O=function(t){u()(r,t);var e,n=(e=r,function(){var t,n=p()(e);if(m()){var r=p()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return l()(this,t)});function r(){return a()(this,r),n.apply(this,arguments)}return o()(r,[{key:"hasAttachmentsRole",value:function(){var t=h.default.get("user");if(!t)return!1;if(t.isSuperuser)return!0;var e=this.props.organization,n=e.availableRoles,r=e.attachmentsRole,a=e.role;if(!Array.isArray(n))return!1;var c=n.map((function(t){return t.id})),o=c.indexOf(r);return c.indexOf(a||"")>=o}},{key:"getDownloadUrl",value:function(){var t=this.props,e=t.attachment,n=t.organization,r=t.eventId,a=t.projectId;return"/api/0/projects/".concat(n.slug,"/").concat(a,"/events/").concat(r,"/attachments/").concat(e.id,"/")}},{key:"render",value:function(){return(0,this.props.children)(this.hasAttachmentsRole()?this.getDownloadUrl():null)}}]),r}(b.a.PureComponent);O.displayName="AttachmentUrl",e.a=Object(y.a)(O)},1785:function(t,e,n){"use strict";var r=n(21),a=n.n(r),c=n(26),o=n.n(c),i=n(9),u=n.n(i),s=n(10),l=n.n(s),f=n(11),p=n.n(f),d=n(12),b=n.n(d),h=n(6),y=n.n(h),m=n(4),O=n(1),v=n.n(O),j=n(3),g=n(29),D=n(8),w=n(279),A=n(17),R=n(56),I=n(0);function x(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var P=function(t){p()(r,t);var e,n=(e=r,function(){var t,n=y()(e);if(x()){var r=y()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return b()(this,t)});function r(){var t;u()(this,r);for(var e=arguments.length,c=new Array(e),i=0;i<e;i++)c[i]=arguments[i];return(t=n.call.apply(n,[this].concat(c))).handleDelete=o()(a.a.mark((function e(){var n,r,c,o,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.props,r=n.api,c=n.url,o=n.onDelete,i=n.attachmentId,!c){e.next=10;break}return e.prev=2,e.next=5,r.requestPromise(c,{method:"DELETE"});case 5:o(i),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(2);case 10:case"end":return e.stop()}}),e,null,[[2,8]])}))),t}return l()(r,[{key:"render",value:function(){var t=this.props.url;return Object(I.f)(v.a.Fragment,null,Object(I.f)(k,{size:"xsmall",icon:Object(I.f)(A.u,{size:"xs"}),href:t?"".concat(t,"?download=1"):"",disabled:!t,title:t?void 0:Object(j.b)("Insufficient permissions to download attachments")},Object(j.b)("Download")),Object(I.f)(w.a,{confirmText:Object(j.b)("Delete"),message:Object(j.b)("Are you sure you wish to delete this file?"),priority:"danger",onConfirm:this.handleDelete,disabled:!t},Object(I.f)(g.a,{size:"xsmall",icon:Object(I.f)(A.s,{size:"xs"}),disabled:!t,priority:"danger",title:t?void 0:Object(j.b)("Insufficient permissions to delete attachments")})))}}]),r}(v.a.Component);P.displayName="EventAttachmentActions";var k=Object(m.a)(g.a,{target:"ewomrm90",label:"DownloadButton"})("margin-right:",Object(D.a)(.5),";");e.a=Object(R.a)(P)},1921:function(t,e,n){var r=n(284),a=n(172);t.exports=function(t){return a(t)&&r(t)}},2608:function(t,e,n){var r=n(885),a=n(653),c=n(2609),o=n(1921),i=a((function(t){return c(r(t,o))}));t.exports=i},2609:function(t,e,n){var r=n(2610),a=n(498),c=n(646);t.exports=function(t,e,n){var o=t.length;if(o<2)return o?c(t[0]):[];for(var i=-1,u=Array(o);++i<o;)for(var s=t[i],l=-1;++l<o;)l!=i&&(u[i]=r(u[i]||s,t[l],e,n));return c(a(u,1),e,n)}},2610:function(t,e,n){var r=n(662),a=n(884),c=n(888),o=n(337),i=n(340),u=n(663);t.exports=function(t,e,n,s){var l=-1,f=a,p=!0,d=t.length,b=[],h=e.length;if(!d)return b;n&&(e=o(e,i(n))),s?(f=c,p=!1):e.length>=200&&(f=u,p=!1,e=new r(e));t:for(;++l<d;){var y=t[l],m=null==n?y:n(y);if(y=s||0!==y?y:0,p&&m==m){for(var O=h;O--;)if(e[O]===m)continue t;b.push(y)}else f(e,m,s)||b.push(y)}return b}},2836:function(t,e,n){"use strict";n.r(e);var r=n(1),a=n.n(r),c=n(184),o=n(78),i=n(635),u=n(16),s=n.n(u),l=n(30),f=n.n(l),p=n(9),d=n.n(p),b=n(10),h=n.n(b),y=n(139),m=n.n(y),O=n(11),v=n.n(O),j=n(12),g=n.n(j),D=n(6),w=n.n(D),A=n(330),R=n.n(A),I=n(7),x=n(277),P=n(3),k=n(378),z=n(50),S=n(619),E=n(1587),N=n(4),T=n(101),C=n(1596),M=n(1634),q=n(1757),L=n(1785),Y={"event.minidump":Object(P.b)("Minidump"),"event.applecrashreport":Object(P.b)("Apple Crash Report"),"event.attachment":Object(P.b)("Other")},F=n(0),B=function(t){var e=t.attachment,n=t.projectId,r=t.onDelete,a=t.isDeleted,c=t.orgId,o=t.groupId;return Object(F.f)(G,{isDeleted:a},Object(F.f)("td",null,Object(F.f)("h5",null,e.name,Object(F.f)("br",null),Object(F.f)("small",null,Object(F.f)(C.a,{date:e.dateCreated})," Â·"," ",Object(F.f)(T.a,{to:"/organizations/".concat(c,"/issues/").concat(o,"/events/").concat(e.event_id,"/")},e.event_id)))),Object(F.f)("td",null,Y[e.type]||Object(P.b)("Other")),Object(F.f)("td",null,Object(F.f)(M.a,{bytes:e.size})),Object(F.f)("td",null,Object(F.f)(q.a,{projectId:n,eventId:e.event_id,attachment:e},(function(t){return!a&&Object(F.f)(L.a,{url:t,onDelete:r,attachmentId:e.id})}))))};B.displayName="GroupEventAttachmentsTableRow";var G=Object(N.a)("tr",{target:"ekv38qo0",label:"TableRow"})("opacity:",(function(t){return t.isDeleted?.3:1}),";td{text-decoration:",(function(t){return t.isDeleted?"line-through":"normal"}),";}"),H=B,U=function(t){var e=t.attachments,n=t.orgId,r=t.projectId,a=t.groupId,c=t.onDelete,o=t.deletedAttachments,i=[Object(P.b)("Name"),Object(P.b)("Type"),Object(P.b)("Size"),Object(P.b)("Actions")];return Object(F.f)("table",{className:"table events-table"},Object(F.f)("thead",null,Object(F.f)("tr",null,i.map((function(t){return Object(F.f)("th",{key:t},t)})))),Object(F.f)("tbody",null,e.map((function(t){return Object(F.f)(H,{key:t.id,attachment:t,orgId:n,projectId:r,groupId:a,onDelete:c,isDeleted:o.some((function(e){return t.id===e}))})}))))};U.displayName="GroupEventAttachmentsTable";var W=U,_=n(182),J=n.n(_),Q=n(2608),K=n.n(Q),V=n(8),X=n(162),Z=n(29);function $(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var tt=function(t){var e=t.location,n=e.query,r=e.pathname,a=n.types,c=["event.minidump","event.applecrashreport"],o=J()(n,"types"),i=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$(Object(n),!0).forEach((function(e){s()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},n,{types:c}),u="";return void 0===a?u="all":0===K()(c,a).length&&(u="onlyCrash"),Object(F.f)(et,null,Object(F.f)(X.a,{merged:!0,active:u},Object(F.f)(Z.a,{barId:"all",size:"small",to:{pathname:r,query:o}},Object(P.b)("All Attachments")),Object(F.f)(Z.a,{barId:"onlyCrash",size:"small",to:{pathname:r,query:i}},Object(P.b)("Only Crash Reports"))))};tt.displayName="GroupEventAttachmentsFilter";var et=Object(N.a)("div",{target:"eoyp7bi0",label:"FilterWrapper"})("display:flex;justify-content:flex-end;margin-bottom:",Object(V.a)(3),";"),nt=Object(I.withRouter)(tt);function rt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function at(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rt(Object(n),!0).forEach((function(e){s()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var ot=function(t){v()(r,t);var e,n=(e=r,function(){var t,n=w()(e);if(ct()){var r=w()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return g()(this,t)});function r(){var t;d()(this,r);for(var e=arguments.length,a=new Array(e),c=0;c<e;c++)a[c]=arguments[c];return(t=n.call.apply(n,[this].concat(a))).handleDelete=function(e){t.setState((function(t){return{deletedAttachments:[].concat(f()(t.deletedAttachments),[e])}}))},t}return h()(r,[{key:"getDefaultState",value:function(){return at({},m()(w()(r.prototype),"getDefaultState",this).call(this),{deletedAttachments:[]})}},{key:"getEndpoints",value:function(){var t=this.props,e=t.params,n=t.location;return[["eventAttachments","/issues/".concat(e.groupId,"/attachments/"),{query:at({},R()(n.query,["cursor","environment","types"]),{limit:50})}]]}},{key:"renderNoQueryResults",value:function(){return Object(F.f)(k.a,null,Object(F.f)("p",null,Object(P.b)("Sorry, no event attachments match your search query.")))}},{key:"renderEmpty",value:function(){return Object(F.f)(k.a,null,Object(F.f)("p",null,Object(P.b)("There don't seem to be any event attachments yet.")))}},{key:"renderLoading",value:function(){return this.renderBody()}},{key:"renderInnerBody",value:function(){var t=this.props,e=t.projectSlug,n=t.params,r=t.location,a=this.state,c=a.loading,o=a.eventAttachments,i=a.deletedAttachments;return c?Object(F.f)(z.default,null):o.length>0?Object(F.f)(W,{attachments:o,orgId:n.orgId,projectId:e,groupId:n.groupId,onDelete:this.handleDelete,deletedAttachments:i}):r.query.types?this.renderNoQueryResults():this.renderEmpty()}},{key:"renderBody",value:function(){return Object(F.f)(a.a.Fragment,null,Object(F.f)(nt,null),Object(F.f)(x.a,{className:"event-list"},Object(F.f)(x.c,null,this.renderInnerBody())),Object(F.f)(S.a,{pageLinks:this.state.eventAttachmentsPageLinks}))}}]),r}(E.a),it=I.withRouter(ot),ut=function(t){var e=t.organization,n=t.group;return Object(F.f)(c.a,{features:["event-attachments"],organization:e,renderDisabled:function(t){return Object(F.f)(i.a,t)}},Object(F.f)(it,{projectSlug:n.project.slug}))};ut.displayName="GroupEventAttachmentsContainer";e.default=Object(o.a)(ut)}}]);
//# sourceMappingURL=GroupEventAttachments.js.map