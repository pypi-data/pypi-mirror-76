(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[97],{1588:function(e,t,n){"use strict";var a=n(15),r=n.n(a),o=n(9),i=n.n(o),s=n(10),c=n.n(s),l=n(11),u=n.n(l),d=n(12),f=n.n(d),m=n(6),b=n.n(m),p=n(4),h=n(1),g=n.n(h),y=n(8),v=n(221),O=n(0);function j(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var T=function(e){u()(a,e);var t,n=(t=a,function(){var e,n=b()(t);if(j()){var a=b()(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return f()(this,e)});function a(){return i()(this,a),n.apply(this,arguments)}return c()(a,[{key:"render",value:function(){var e=this.props,t=e.icon,n=e.title,a=e.action,o=e.tabs,i=e.noTitleStyles,s=r()(e,["icon","title","action","tabs","noTitleStyles"]);return Object(O.f)("div",s,Object(O.f)(R,null,t&&Object(O.f)(w,null,t),n&&Object(O.f)(x,{tabs:o,styled:i},Object(O.f)(v.a,null,n)),a&&Object(O.f)(S,{tabs:o},a)),o&&Object(O.f)("div",null,o))}}]),a}(g.a.Component);T.displayName="SettingsPageHeading",T.defaultProps={noTitleStyles:!1};var R=Object(p.a)("div",{target:"e1uay4fd0",label:"TitleAndActions"})({name:"70qvj9",styles:"display:flex;align-items:center;"}),x=Object(p.a)("div",{target:"e1uay4fd1",label:"Title"})((function(e){return!e.styled&&"\n    font-size: 20px;\n    font-weight: bold;"}),";margin:",(function(e){return e.tabs?"".concat(Object(y.a)(4)," ").concat(Object(y.a)(2)," ").concat(Object(y.a)(2)," 0"):"".concat(Object(y.a)(4)," ").concat(Object(y.a)(2)," ").concat(Object(y.a)(4)," 0")}),";flex:1;"),w=Object(p.a)("div",{target:"e1uay4fd2",label:"Icon"})("margin-right:",Object(y.a)(1),";"),S=Object(p.a)("div",{target:"e1uay4fd3",label:"Action"})((function(e){return e.tabs?"margin-top: ".concat(Object(y.a)(2)):null}),";"),k=Object(p.a)(T,{target:"e1uay4fd4",label:"StyledSettingsPageHeading"})("font-size:14px;margin-top:-",Object(y.a)(4),";");t.a=k},1761:function(e,t,n){"use strict";var a=n(4),r=n(0),o=n(109),i=function(e){return Object(r.e)("display:block;width:1rem;height:1rem;border-radius:50%;background-color:",e.theme.green400,";animation:0.2s ",o.d," ease;opacity:",e.disabled?.4:null,";")},s=Object(a.a)("input",{target:"e1d7o7s40",label:"Radio"})("display:flex;padding:0;width:1.5em;height:1.5em;position:relative;border-radius:50%;align-items:center;justify-content:center;border:1px solid ",(function(e){return e.theme.borderLight}),";box-shadow:inset 0 1px 1px rgba(0,0,0,0.04);background:none;appearance:none;margin:0 !important;&:focus,&.focus-visible{outline:none !important;border:1px solid ",(function(e){return e.theme.borderDark}),";box-shadow:rgba(209,202,216,0.5) 0 0 0 3px;}&:checked:after{content:'';",i,"}");s.defaultProps={type:"radio"},t.a=s},1898:function(e,t,n){"use strict";var a=n(21),r=n.n(a),o=n(26),i=n.n(o),s=n(9),c=n.n(s),l=n(10),u=n.n(l),d=n(11),f=n.n(d),m=n(12),b=n.n(m),p=n(6),h=n.n(p),g=n(4),y=n(1),v=n.n(y),O=n(126),j=n.n(O),T=n(28),R=n(277),x=n(17),w=n(3),S=n(29),k=n(279),A=n(283),z=n(379),E=n(618),D=n(101),M=n(8),P=n(56),N=n(0);function C(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var I=function(e){f()(a,e);var t,n=(t=a,function(){var e,n=h()(t);if(C()){var a=h()(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return b()(this,e)});function a(){var e;c()(this,a);for(var t=arguments.length,o=new Array(t),s=0;s<t;s++)o[s]=arguments[s];return(e=n.call.apply(n,[this].concat(o))).state={loading:!0,teams:null},e.fetchTeams=j()(function(){var t=i()(r.a.mark((function t(n){var a,o,i,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props,o=a.api,i=a.organization,t.next=3,o.requestPromise("/organizations/".concat(i.slug,"/teams/"),{query:{query:n,per_page:T.J}});case 3:s=t.sent,e.setState({teams:s,loading:!1});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),T.l),e.handleQueryUpdate=function(t){e.setState({loading:!0}),e.fetchTeams(t.target.value)},e.handleAddTeam=function(t){var n=e.state.teams.find((function(e){return e.slug===t.value}));e.props.onAddTeam(n)},e.handleRemove=function(t){e.props.onRemoveTeam(t)},e}return u()(a,[{key:"componentDidMount",value:function(){this.fetchTeams()}},{key:"renderTeamAddDropDown",value:function(){var e,t=this.props,n=t.disabled,a=t.selectedTeams,r=t.menuHeader,o=this.state.teams,i=null===o||0===o.length,s=n;return e=i?[]:o.filter((function(e){return!a.includes(e.slug)})).map((function(e){return{value:e.slug,searchKey:e.slug,label:Object(N.f)(q,null,"#",e.slug)}})),Object(N.f)(A.a,{items:e,busyItemsStillVisible:this.state.loading,onChange:this.handleQueryUpdate,onSelect:this.handleAddTeam,emptyMessage:Object(w.b)("No teams"),menuHeader:r,disabled:s},(function(e){var t=e.isOpen;return Object(N.f)(z.a,{"aria-label":Object(w.b)("Add Team"),isOpen:t,size:"xsmall",disabled:s},Object(w.b)("Add Team"))}))}},{key:"renderBody",value:function(){var e=this,t=this.props,n=t.organization,a=t.selectedTeams,r=t.disabled,o=t.confirmLastTeamRemoveMessage;if(0===a.length)return Object(N.f)(E.a,null,Object(w.b)("No Teams assigned"));var i=1===a.length&&o?o:null;return a.map((function(t){return Object(N.f)(L,{key:t,orgId:n.slug,team:t,onRemove:e.handleRemove,disabled:r,confirmMessage:i})}))}},{key:"render",value:function(){return Object(N.f)(R.a,null,Object(N.f)(R.e,{hasButtons:!0},Object(w.b)("Team"),this.renderTeamAddDropDown()),Object(N.f)(R.c,null,this.renderBody()))}}]),a}(v.a.Component);I.displayName="TeamSelect";var L=function(e){var t=e.orgId,n=e.team,a=e.onRemove,r=e.disabled,o=e.confirmMessage;return Object(N.f)(U,null,Object(N.f)(B,{to:"/settings/".concat(t,"/teams/").concat(n,"/")},"#".concat(n)),Object(N.f)(k.a,{message:o,bypass:!o,onConfirm:function(){return a(n)},disabled:r},Object(N.f)(S.a,{size:"xsmall",icon:Object(N.f)(x.xb,{isCircled:!0,size:"xs"}),disabled:r},Object(w.b)("Remove"))))};L.displayName="TeamRow";var q=Object(g.a)("div",{target:"e2fk6ws0",label:"TeamDropdownElement"})("padding:",Object(M.a)(.5)," ",Object(M.a)(.25),";text-transform:none;"),U=Object(g.a)(R.f,{target:"e2fk6ws1",label:"TeamPanelItem"})("padding:",Object(M.a)(2),";align-items:center;"),B=Object(g.a)(D.a,{target:"e2fk6ws2",label:"StyledLink"})("flex:1;margin-right:",Object(M.a)(1),";");t.a=Object(P.a)(I)},2034:function(e,t,n){"use strict";var a=n(9),r=n.n(a),o=n(10),i=n.n(o),s=n(11),c=n.n(s),l=n(12),u=n.n(l),d=n(6),f=n.n(d),m=n(4),b=n(1),p=n.n(b),h=n(277),g=n(3),y=n(1761),v=n(620),O=n(0);function j(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var T=Object(m.a)("label",{target:"e1noblkb0",label:"Label"})({name:"muoiou",styles:"display:flex;flex:1;align-items:center;margin-bottom:0;"}),R=function(e){c()(a,e);var t,n=(t=a,function(){var e,n=f()(t);if(j()){var a=f()(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return u()(this,e)});function a(){return r()(this,a),n.apply(this,arguments)}return i()(a,[{key:"render",value:function(){var e=this,t=this.props,n=t.disabled,a=t.enforceAllowed,r=t.roleList,o=t.selectedRole;return Object(O.f)(h.a,null,Object(O.f)(h.e,null,Object(g.b)("Role")),Object(O.f)(h.c,null,r.map((function(t){var r=t.desc,i=t.name,s=t.id,c=t.allowed,l=n||a&&!c;return Object(O.f)(h.f,{key:s,onClick:function(){return!l&&e.props.setRole(s)},css:l?{color:"grey",cursor:"default"}:{}},Object(O.f)(T,null,Object(O.f)(y.a,{id:s,value:i,checked:s===o,readOnly:!0}),Object(O.f)("div",{style:{flex:1,padding:"0 16px"}},i,Object(O.f)(v.a,{noMargin:!0},Object(O.f)("div",{className:"help-block"},r)))))}))))}}]),a}(p.a.Component);R.displayName="RoleSelect",t.a=R},2752:function(e,t,n){"use strict";n.r(t),n.d(t,"InviteMember",(function(){return C}));var a=n(9),r=n.n(a),o=n(10),i=n.n(o),s=n(11),c=n.n(s),l=n(12),u=n.n(l),d=n(6),f=n.n(d),m=n(7),b=n(1),p=n.n(b),h=n(46),g=n.n(h),y=n(43),v=n(31),O=n(28),j=n(3),T=n(56),R=n(78),x=n(29),w=n(35),S=n(50),k=n(1588),A=n(620),z=n(389),E=n(1898),D=n(484),M=n(2034),P=n(0);function N(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var C=function(e){c()(a,e);var t,n=(t=a,function(){var e,n=f()(t);if(N()){var a=f()(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return u()(this,e)});function a(e){var t;r()(this,a),(t=n.call(this,e)).redirectToMemberPage=function(){var e=t.props,n=e.params,a=e.router,r=/^\/settings\//.test(a.location.pathname)?"/settings/:orgId/members/":"/organizations/:orgId/members/";a.push(Object(D.a)(r,n))},t.splitEmails=function(e){return e.split(",").map((function(e){return e.trim()})).filter((function(e){return e}))},t.inviteUser=function(e){var n=t.props.organization.slug,a=t.state,r=a.selectedTeams,o=a.selectedRole;return new Promise((function(a,i){t.props.api.request("/organizations/".concat(n,"/members/"),{method:"POST",data:{email:e,teams:Array.from(r.keys()),role:o,referrer:t.props.location.query.referrer},success:function(){Object(v.d)(Object(j.c)("Added [email] to [organization]",{email:e,organization:n})),a()},error:function(t){403===t.status?(Object(v.a)(Object(j.b)("You aren't allowed to invite members.")),a()):409===t.status?(Object(v.a)("User already exists: ".concat(e)),a()):i(t.responseJSON)}})}))},t.submit=function(){var e=t.state.email,n=t.splitEmails(e);n.length&&(t.setState({busy:!0}),Promise.all(n.map(t.inviteUser)).then((function(){return t.redirectToMemberPage()})).catch((function(e){!e||e.email||e.role||y.m((function(n){n.setExtra("error",e),n.setExtra("state",t.state),y.c(new Error("Unknown invite member api response"))})),t.setState({error:e,busy:!1})})))},t.handleAddTeam=function(e){var n=t.state.selectedTeams;n.has(e.slug)||n.add(e.slug),t.setState({selectedTeams:n})},t.handleRemoveTeam=function(e){var n=t.state.selectedTeams;n.delete(e),t.setState({selectedTeams:n})};var o=e.organization.teams,i=1===o.length?[o[0].slug]:[];return t.state={selectedTeams:new Set(i),roleList:[],selectedRole:"member",email:"",loading:!0,busy:!1,error:void 0},t}return i()(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.organization.slug,n=w.default.get("user").isSuperuser;this.props.api.request("/organizations/".concat(t,"/members/me/"),{method:"GET",success:function(t){var n=(t||{}).roles;t&&n?(e.setState({roleList:n,loading:!1}),0===n.filter((function(e){return e.allowed})).length&&e.redirectToMemberPage()):(e.setState({loading:!1,error:{role:'Error loading roles, will default to "member"'}}),y.m((function(n){n.setExtra("resp",t),n.setExtra("state",e.state),y.c(new Error("[members]: data fetch invalid response"))})))},error:function(t){404===t.status&&n?e.setState({roleList:O.B,loading:!1}):0!==t.status&&y.m((function(n){n.setExtra("error",t),n.setExtra("state",e.state),y.c(new Error("[members]: data fetch error"))})),Object(v.a)(Object(j.b)("Error with request, please reload"))}})}},{key:"render",value:function(){var e=this,t=this.state,n=t.error,a=t.loading,r=t.roleList,o=t.selectedRole,i=t.selectedTeams,s=this.props.organization,c=w.default.getConfig().invitesEnabled,l=w.default.get("user").isSuperuser;return Object(P.f)("div",null,Object(P.f)(k.a,{title:Object(j.b)("Add Member to Organization")}),Object(P.f)(A.a,null,c?Object(j.b)("Invite a member to join this organization via their email address. If they do not already have an account, they will first be asked to create one. Multiple emails delimited by commas."):Object(j.b)("You may add a user by their username if they already have an account. Multiple inputs delimited by commas.")),a&&Object(P.f)(S.default,null),!a&&Object(P.f)("div",null,Object(P.f)("div",{className:g()({"has-error":n&&n.email})},Object(P.f)(z.a,{name:"email",label:c?Object(j.b)("Email")+"(s)":Object(j.b)("Username")+"(s)",placeholder:"e.g. teammate@example.com",spellCheck:"false",onChange:function(t){return e.setState({email:t})}}),n&&n.email&&Object(P.f)("p",{className:"error"},n.email)),n&&n.role&&Object(P.f)("p",{className:"error alert-error"},n.role),Object(P.f)(M.a,{enforceAllowed:!l,roleList:r,selectedRole:o,setRole:function(t){return e.setState({selectedRole:t})}}),Object(P.f)(E.a,{organization:s,selectedTeams:Array.from(i.values()),onAddTeam:this.handleAddTeam,onRemoveTeam:this.handleRemoveTeam}),Object(P.f)(x.a,{priority:"primary",busy:this.state.busy,className:"invite-member-submit",onClick:this.submit},Object(j.b)("Add Member"))))}}]),a}(p.a.Component);C.displayName="InviteMember",t.default=Object(T.a)(Object(m.withRouter)(Object(R.a)(C)))}}]);
//# sourceMappingURL=InviteMember.js.map