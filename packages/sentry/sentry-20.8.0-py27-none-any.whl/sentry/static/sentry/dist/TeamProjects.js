(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[208],{2097:function(t,e,n){"use strict";var r=n(9),a=n.n(r),c=n(10),o=n.n(c),s=n(11),i=n.n(s),l=n(12),u=n.n(l),f=n(6),p=n.n(f),d=n(4),j=n(1),h=n.n(j),b=n(666),m=n(101),g=n(5),v=n.n(g),y=n(15),O=n.n(y),k=n(0);function P(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var R=function(t){i()(r,t);var e,n=(e=r,function(){var t,n=p()(e);if(P()){var r=p()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return u()(this,t)});function r(){return a()(this,r),n.apply(this,arguments)}return o()(r,[{key:"render",value:function(){var t=this.props,e=t.project,n=O()(t,["project"]);return Object(k.f)("span",v()({className:"project-label"},n),Object(k.f)("span",{className:"project-name"},e.slug))}}]),r}(h.a.PureComponent);R.displayName="ProjectLabel";var S=n(8);function z(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var I=function(t){i()(r,t);var e,n=(e=r,function(){var t,n=p()(e);if(z()){var r=p()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return u()(this,t)});function r(t){var e;return a()(this,r),(e=n.call(this,t)).handleToggleBookmark=function(t){e.setState({isBookmarked:t})},e.state={isBookmarked:e.props.project.isBookmarked},e}return o()(r,[{key:"render",value:function(){var t=this.props,e=t.project,n=t.organization;return Object(k.f)(L,{key:e.id},Object(k.f)(T,{organization:n,project:e,isBookmarked:this.state.isBookmarked,onToggle:this.handleToggleBookmark}),Object(k.f)(m.a,{to:"/settings/".concat(n.slug,"/projects/").concat(e.slug,"/")},Object(k.f)(R,{project:e})))}}]),r}(h.a.Component);I.displayName="ProjectItem";var L=Object(d.a)("div",{target:"enngb6z0",label:"Container"})({name:"70qvj9",styles:"display:flex;align-items:center;"}),T=Object(d.a)(b.a,{target:"enngb6z1",label:"BookmarkLink"})("margin-right:",Object(S.a)(1),";margin-top:-",Object(S.a)(.25),";");e.a=I},2757:function(t,e,n){"use strict";n.r(e),n.d(e,"TeamProjects",(function(){return W}));var r=n(5),a=n.n(r),c=n(41),o=n.n(c),s=n(9),i=n.n(s),l=n(10),u=n.n(l),f=n(11),p=n.n(f),d=n(12),j=n.n(d),h=n(6),b=n.n(h),m=n(4),g=n(1),v=n.n(g),y=n(277),O=n(31),k=n(25),P=n(17),R=n(3),S=n(29),z=n(283),I=n(379),L=n(618),T=n(183),q=n(50),x=n(619),w=n(40),A=n(2097),C=n(39),B=n(8),D=n(56),N=n(78),U=n(0);function E(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var W=function(t){p()(r,t);var e,n=(e=r,function(){var t,n=b()(e);if(E()){var r=b()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return j()(this,t)});function r(){var t;i()(this,r);for(var e=arguments.length,a=new Array(e),c=0;c<e;c++)a[c]=arguments[c];return(t=n.call.apply(n,[this].concat(a))).state={error:!1,loading:!0,pageLinks:null,unlinkedProjects:[],linkedProjects:[]},t.fetchAll=function(){t.fetchTeamProjects(),t.fetchUnlinkedProjects()},t.fetchTeamProjects=function(){var e=t.props,n=e.location,r=e.params,a=r.orgId,c=r.teamId;t.setState({loading:!0}),t.props.api.requestPromise("/organizations/".concat(a,"/projects/"),{query:{query:"team:".concat(c),cursor:n.query.cursor||""},includeAllArgs:!0}).then((function(e){var n=o()(e,3),r=n[0],a=(n[1],n[2]);t.setState({loading:!1,error:!1,linkedProjects:r,pageLinks:a.getResponseHeader("Link")})})).catch((function(){t.setState({loading:!1,error:!0})}))},t.fetchUnlinkedProjects=function(e){var n=t.props.params,r=n.orgId,a=n.teamId;t.props.api.requestPromise("/organizations/".concat(r,"/projects/"),{query:{query:e?"!team:".concat(a," ").concat(e):"!team:".concat(a)}}).then((function(e){t.setState({unlinkedProjects:e})}))},t.handleLinkProject=function(e,n){var r=t.props.params,a=r.orgId,c=r.teamId;t.props.api.request("/projects/".concat(a,"/").concat(e.slug,"/teams/").concat(c,"/"),{method:"add"===n?"POST":"DELETE",success:function(e){t.fetchAll(),w.a.updateSuccess(e),Object(O.d)("add"===n?Object(R.b)("Successfully added project to team."):Object(R.b)("Successfully removed project from team"))},error:function(){Object(O.a)(Object(R.b)("Wasn't able to change project association."))}})},t.handleProjectSelected=function(e){var n=t.state.unlinkedProjects.find((function(t){return t.id===e.value}));t.handleLinkProject(n,"add")},t.handleQueryUpdate=function(e){t.fetchUnlinkedProjects(e.target.value)},t}return u()(r,[{key:"componentDidMount",value:function(){this.fetchAll()}},{key:"componentDidUpdate",value:function(t){t.params.orgId===this.props.params.orgId&&t.params.teamId===this.props.params.teamId||this.fetchAll(),t.location!==this.props.location&&this.fetchTeamProjects()}},{key:"projectPanelContents",value:function(t){var e=this,n=this.props.organization,r=new Set(n.access).has("org:write");return t.length?Object(k.v)(t).map((function(t){return Object(U.f)(J,{key:t.id},Object(U.f)(A.a,{project:t,organization:n}),Object(U.f)(C.a,{disabled:r,title:Object(R.b)("You do not have enough permission to change project association.")},Object(U.f)(S.a,{size:"small",disabled:!r,icon:Object(U.f)(P.xb,{isCircled:!0,size:"xs"}),onClick:function(){e.handleLinkProject(t,"remove")}},Object(R.b)("Remove"))))})):Object(U.f)(L.a,{size:"large",icon:Object(U.f)(P.C,{size:"xl"})},Object(R.b)("This team doesn't have access to any projects."))}},{key:"render",value:function(){var t=this,e=this.state,n=e.linkedProjects,r=e.unlinkedProjects,c=e.error,o=e.loading;if(c)return Object(U.f)(T.a,{onRetry:function(){return t.fetchAll()}});if(o)return Object(U.f)(q.default,null);var s=new Set(this.props.organization.access),i=r.map((function(t){return{value:t.id,searchKey:t.slug,label:Object(U.f)(M,null,t.slug)}}));return Object(U.f)(v.a.Fragment,null,Object(U.f)(y.a,null,Object(U.f)(y.e,{hasButtons:!0},Object(U.f)("div",null,Object(R.b)("Projects")),Object(U.f)("div",{style:{textTransform:"none"}},s.has("org:write")?Object(U.f)(z.a,{items:i,onChange:this.handleQueryUpdate,onSelect:this.handleProjectSelected,emptyMessage:Object(R.b)("No projects")},(function(t){var e=t.isOpen;return Object(U.f)(I.a,{isOpen:e,size:"xsmall"},Object(R.b)("Add Project"))})):Object(U.f)(I.a,{disabled:!0,title:Object(R.b)("You do not have enough permission to associate a project."),size:"xsmall"},Object(R.b)("Add Project")))),Object(U.f)(y.c,null,this.projectPanelContents(n))),Object(U.f)(x.a,a()({pageLinks:this.state.pageLinks},this.props)))}}]),r}(v.a.Component);W.displayName="TeamProjects";var J=Object(m.a)(y.f,{target:"eqsa6vb0",label:"StyledPanelItem"})("display:flex;align-items:center;justify-content:space-between;padding:",Object(B.a)(2),";"),M=Object(m.a)("div",{target:"eqsa6vb1",label:"ProjectListElement"})("padding:",Object(B.a)(.25)," 0;");e.default=Object(D.a)(Object(N.a)(W))}}]);
//# sourceMappingURL=TeamProjects.js.map