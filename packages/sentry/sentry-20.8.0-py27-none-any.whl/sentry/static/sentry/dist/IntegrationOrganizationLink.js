(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[96],{1586:function(t,n,e){"use strict";e.d(n,"a",(function(){return h}));var r=e(9),a=e.n(r),i=e(10),o=e.n(i),c=e(11),s=e.n(c),l=e(12),u=e.n(l),f=e(6),g=e.n(f),p=e(278),d=e.n(p),v=(e(1),e(1587)),O=e(0);function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var h=function(t){s()(r,t);var n,e=(n=r,function(){var t,e=g()(n);if(b()){var r=g()(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return u()(this,t)});function r(){return a()(this,r),e.apply(this,arguments)}return o()(r,[{key:"getTitle",value:function(){return""}},{key:"render",value:function(){var t=this.getTitle();return Object(O.f)(d.a,{title:"".concat(t?"".concat(t," - "):"","Sentry")},this.renderComponent())}}]),r}(v.a);h.displayName="AsyncView"},2763:function(t,n,e){"use strict";e.r(n),e.d(n,"default",(function(){return J}));var r=e(21),a=e.n(r),i=e(41),o=e.n(i),c=e(26),s=e.n(c),l=e(16),u=e.n(l),f=e(9),g=e.n(f),p=e(10),d=e.n(p),v=e(11),O=e.n(v),b=e(12),h=e.n(b),y=e(6),j=e.n(y),m=e(4),z=e(1),k=e.n(z),w=e(94),S=e(62),P=e(31),I=e(3),C=e(630),A=e(80),B=e(1586),R=e(29),V=e(626),x=e(336),D=e(163),E=e(282),N=e(17),_=e(50),q=e(0);function F(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function T(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?F(Object(e),!0).forEach((function(n){u()(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):F(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function W(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var J=function(t){O()(r,t);var n,e=(n=r,function(){var t,e=j()(n);if(W()){var r=j()(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return h()(this,t)});function r(){var t;g()(this,r);for(var n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return(t=e.call.apply(e,[this].concat(i))).trackIntegrationEvent=function(n,e){var r=t.state,a=r.organization,i=r.provider;a&&i&&Object(C.k)(T({},n,{integration_type:"first_party",integration:i.key,already_installed:!1,view:"external_install"}),a,{startSession:!!e})},t.getOrgBySlug=function(n){return t.state.organizations.find((function(t){return t.slug===n}))},t.onSelectOrg=function(){var n=s()(a.a.mark((function n(e){var r,i,c,s,l;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.value,t.setState({selectedOrgSlug:r,reloading:!0,organization:void 0}),n.prev=2,n.next=5,Promise.all([t.api.requestPromise("/organizations/".concat(r,"/")),t.api.requestPromise("/organizations/".concat(r,"/config/integrations/?provider_key=").concat(t.integrationSlug))]);case 5:if(i=n.sent,c=o()(i,2),s=c[0],0!==(l=c[1].providers).length){n.next=11;break}throw new Error("Invalid provider");case 11:t.setState({organization:s,reloading:!1,provider:l[0]},t.trackOpened),n.next=18;break;case 14:n.prev=14,n.t0=n.catch(2),Object(P.a)(Object(I.b)("Failed to retrieve organization or integration details")),t.setState({reloading:!1});case 18:case"end":return n.stop()}}),n,null,[[2,14]])})));return function(t){return n.apply(this,arguments)}}(),t.hasAccess=function(){var n=t.state.organization;return null==n?void 0:n.access.includes("org:integrations")},t.customOption=function(n){var e=t.getOrgBySlug(n.value);return e?Object(q.f)(S.z.Option,n,Object(q.f)(E.a,{organization:e,avatarSize:20,displayName:e.name,avatarProps:{consistentWidth:!0}})):null},t.customValueContainer=function(n){var e=n.getValue();if(0===e.length)return Object(q.f)(S.z.ValueContainer,n);var r=e[0].value,a=t.getOrgBySlug(r);return a?Object(q.f)(S.z.ValueContainer,n,Object(q.f)(E.a,{organization:a,avatarSize:20,displayName:a.name,avatarProps:{consistentWidth:!0}})):Object(q.f)(S.z.ValueContainer,n)},t}return d()(r,[{key:"getEndpoints",value:function(){return[["organizations","/organizations/"]]}},{key:"getTitle",value:function(){return Object(I.b)("Choose Installation Organization")}},{key:"trackOpened",value:function(){this.trackIntegrationEvent({eventKey:"integrations.integration_viewed",eventName:"Integrations: Integration Viewed"},!0)}},{key:"trackInstallationStart",value:function(){this.trackIntegrationEvent({eventKey:"integrations.installation_start",eventName:"Integrations: Installation Start"})}},{key:"renderAddButton",value:function(t){var n=this.state,e=n.organization,r=n.provider;return r?Object(q.f)(R.a,{priority:"primary",disabled:!e||!this.hasAccess(),onClick:t},Object(I.b)("Install %s",r.name)):null}},{key:"renderAddButtonContainer",value:function(){var t=this;if(this.props.params.installationId)throw new Error("Not implemented yet");return this.renderAddButton((function(){var n=T({orgSlug:t.state.selectedOrgSlug},t.queryParams);t.trackInstallationStart(),window.location.assign("/extensions/".concat(t.integrationSlug,"/configure/?").concat(Object(w.f)(n)))}))}},{key:"renderBottom",value:function(){var t=this.state,n=t.organization,e=t.selectedOrgSlug,r=t.provider,a=t.reloading,i=Object(C.d)().FeatureList;return a?Object(q.f)(_.default,null):Object(q.f)(k.a.Fragment,null,e&&n&&!this.hasAccess()&&Object(q.f)(A.b,{type:"error",icon:Object(q.f)(N.C,{size:"md"})},Object(q.f)("p",null,Object(I.c)("You do not have permission to install integrations in\n                [organization]. Ask an organization owner or manager to\n                visit this page to finish installing this integration.",{organization:Object(q.f)("strong",null,n.slug)})),Object(q.f)(K,null,window.location.href)),r&&n&&this.hasAccess()&&i&&Object(q.f)(k.a.Fragment,null,Object(q.f)("p",null,Object(I.c)("The following features will be available for [organization] when installed.",{organization:Object(q.f)("strong",null,n.slug)})),Object(q.f)(i,{organization:n,features:r.metadata.features,provider:r})),Object(q.f)("div",{className:"form-actions"},this.renderAddButtonContainer()))}},{key:"renderBody",value:function(){var t=this.state.selectedOrgSlug,n=this.state.organizations.map((function(t){return{value:t.slug,label:t.name}}));return Object(q.f)(x.a,null,Object(q.f)("h3",null,Object(I.b)("Finish integration installation")),Object(q.f)("p",null,Object(I.c)("Please pick a specific [organization:organization] to link with\n            your integration installation of [integation].",{organization:Object(q.f)("strong",null),integation:Object(q.f)("strong",null,this.integrationSlug)})),Object(q.f)(V.a,{label:Object(I.b)("Organization"),inline:!1,stacked:!0,required:!0},Object(q.f)(D.a,{onChange:this.onSelectOrg,value:t,placeholder:Object(I.b)("Select an organization"),options:n,components:{Option:this.customOption,ValueContainer:this.customValueContainer}})),this.renderBottom())}},{key:"integrationSlug",get:function(){return this.props.params.integrationSlug}},{key:"queryParams",get:function(){return this.props.location.query}}]),r}(B.a),K=Object(m.a)("pre",{target:"e11png480",label:"InstallLink"})({name:"1y327hp",styles:"margin-bottom:0;background:#fbe3e1;"})}}]);
//# sourceMappingURL=IntegrationOrganizationLink.js.map