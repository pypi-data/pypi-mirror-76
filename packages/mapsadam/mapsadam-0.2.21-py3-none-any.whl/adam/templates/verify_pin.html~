{% extends "layout.html" %}
{% block content %}
<script>
jQuery(document).ready(function($) {
  $(document).ready(function() {

    var entered_pin = "";
    entered_pin.toString();

    // Jinja code block - Checks for incorrect_pin
    {% if incorrect_pin %} 
    $("#fields").addClass("miss");
    enterCode = "";
    setTimeout(function() {
    $("#fields .numberfield").removeClass("active");
    }, 200);
    setTimeout(function() {
    $("#fields").removeClass("miss");
    }, 500);
    {% endif %}

    $("#numbers button").click(function() {

      var clicked_number = $(this).text().toString();
      entered_pin = entered_pin + clicked_number;
      var pin_length = parseInt(entered_pin.length);
      pin_length--;
      $("#fields .numberfield:eq(" + pin_length + ")").addClass("active");

      if (pin_length == 3) {

        // Check the PIN
        $.get("/confirm_pin", {
            entered_pin: entered_pin
            },
            function(data) {
             window.location.href = "{{ url_for('compare_pins') }}";
            }
        );
      } else {}

    });
  });
});
</script>
<div id="pincode">
    <div class="pin_table">
        <div class="pin_cell">
            <div id="anleitung_enter">
                <p>
                    <h3><b>Enter PIN to unlock</b></h3>
                    {{ remaining_attempts }}/5 attempts remaining
                </p>
            </div>
            <div id="fields">
                <div class="grid">
                    <div class="grid__col grid__col--1-of-4 numberfield"><span></span></div>
                    <div class="grid__col grid__col--1-of-4 numberfield"><span></span></div>
                    <div class="grid__col grid__col--1-of-4 numberfield"><span></span></div>
                    <div class="grid__col grid__col--1-of-4 numberfield"><span></span></div>
                </div>
            </div>
            <div id="numbers">
                <div class="grid">
                    <div class="grid__col grid__col--1-of-3"><button>1</button></div>
                    <div class="grid__col grid__col--1-of-3"><button>2</button></div>
                    <div class="grid__col grid__col--1-of-3"><button>3</button></div>

                    <div class="grid__col grid__col--1-of-3"><button>4</button></div>
                    <div class="grid__col grid__col--1-of-3"><button>5</button></div>
                    <div class="grid__col grid__col--1-of-3"><button>6</button></div>

                    <div class="grid__col grid__col--1-of-3"><button>7</button></div>
                    <div class="grid__col grid__col--1-of-3"><button>8</button></div>
                    <div class="grid__col grid__col--1-of-3"><button>9</button></div>

                    <div class="grid__col grid__col--1-of-3"></div>
                    <div class="grid__col grid__col--1-of-3"><button>0</button></div>
                    <div class="grid__col grid__col--1-of-3"></div>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}
