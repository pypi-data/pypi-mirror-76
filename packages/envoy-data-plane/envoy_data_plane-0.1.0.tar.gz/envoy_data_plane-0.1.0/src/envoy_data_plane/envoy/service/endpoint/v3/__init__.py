# Generated by the protocol buffer compiler.  DO NOT EDIT!
# sources: envoy/service/endpoint/v3/eds.proto
# plugin: python-betterproto
from dataclasses import dataclass
from typing import AsyncIterable, AsyncIterator, Iterable, Union

import betterproto
import grpclib

from ...discovery import v3 as __discovery_v3__


@dataclass
class EdsDummy(betterproto.Message):
    """
    [#not-implemented-hide:] Not configuration. Workaround c++ protobuf issue
    with importing services: https://github.com/google/protobuf/issues/4221 and
    protoxform to upgrade the file.
    """

    pass


class EndpointDiscoveryServiceStub(betterproto.ServiceStub):
    async def stream_endpoints(
        self,
        request_iterator: Union[
            AsyncIterable["__discovery_v3__.DiscoveryRequest"],
            Iterable["__discovery_v3__.DiscoveryRequest"],
        ],
    ) -> AsyncIterator[__discovery_v3__.DiscoveryResponse]:
        """
        The resource_names field in DiscoveryRequest specifies a list of
        clusters to subscribe to updates for.
        """

        async for response in self._stream_stream(
            "/envoy.service.endpoint.v3.EndpointDiscoveryService/StreamEndpoints",
            request_iterator,
            __discovery_v3__.DiscoveryRequest,
            __discovery_v3__.DiscoveryResponse,
        ):
            yield response

    async def delta_endpoints(
        self,
        request_iterator: Union[
            AsyncIterable["__discovery_v3__.DeltaDiscoveryRequest"],
            Iterable["__discovery_v3__.DeltaDiscoveryRequest"],
        ],
    ) -> AsyncIterator[__discovery_v3__.DeltaDiscoveryResponse]:

        async for response in self._stream_stream(
            "/envoy.service.endpoint.v3.EndpointDiscoveryService/DeltaEndpoints",
            request_iterator,
            __discovery_v3__.DeltaDiscoveryRequest,
            __discovery_v3__.DeltaDiscoveryResponse,
        ):
            yield response

    async def fetch_endpoints(self) -> __discovery_v3__.DiscoveryResponse:
        request = __discovery_v3__.DiscoveryRequest()

        return await self._unary_unary(
            "/envoy.service.endpoint.v3.EndpointDiscoveryService/FetchEndpoints",
            request,
            __discovery_v3__.DiscoveryResponse,
        )
